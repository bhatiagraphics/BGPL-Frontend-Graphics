Imports System.Data
Imports System.Data.SqlClient
Imports AGPLERPWEB.DAL
Imports Microsoft.VisualBasic

Namespace AGPLCRM.Class
    Public Class ClsCRMContactForGPAndClient_All_New
        Public Shared UpdateOrNot As String
        '' For GP Details 
        Private mcontactcd As String
        Private mContactdate As String
        Private mltypecd As String
        Private mtitle As String
        Private mcontactname As String
        Private mMiddleName As String
        Private mLastName As String
        Private mGender As String
        Private mcompanyname As String
        Private mSegmentcd As String
        Private msegother As String
        Private mdob As String
        Private mMaritalStatus As String
        Private mSpouceName As String
        Private mDOAnniversary As String
        Private mReligion As String
        Private mNationality As String
        Private mQualificationStatus As String
        Private mSourcecd As String
        Private mrefbyContactcd As String
        Private mRefFreeText As String
        Private mUserID As String
        Private mPassword As String
        Private mmobile As String
        Private mmobile2 As String
        Private mOffice1 As String
        Private mOffice2 As String
        Private mHome1 As String
        Private mHome2 As String
        Private memail As String
        Private mEmail2 As String
        Private mAdd1 As String
        Private mstreet As String
        Private mLocation As String
        Private mCity As String
        Private mState As String
        Private mCountry As String
        Private mPincode As String
        Private mstatuscd As String
        Private mSubIndustryCode As String
        Private mgpsourcecd As String

        '' For Client Details (Extra Fields)
        Private mDesignation As String
        Private mproductcd As String
        Private mleadindcd As String
        Private mcrmIndustryTypecd As String
        Private mYearofEst As String
        Private mAnnualTurnover As String
        Private mNoofEmployeescd As String
        Private mqulificationcd As String
        Private mTypeOfEntity As String
        Private mBIProduct As String

        '' For GP Account
        Private mApplicatinDate As String
        Private mGPCode As String
        Private mPhoto As String
        Private mPhotopath As String
        Private mBankAccNo As String
        Private mBankAccType As String
        Private mBankName As String
        Private mBranch As String
        Private mBankCity As String
        Private mIFSCCode As String
        Private mNomTitle As String
        Private mNomFirstName As String
        Private mNomMiddleName As String
        Private mNomLastName As String
        Private mNomRelationship As String
        Private mNomDOB As String
        Private mNomMobile As String
        Private mNomHomePhoneNo As String
        Private mNomEmail As String
        Private mNomAdd As String
        Private mNomStreet As String
        Private mNomLocation As String
        Private mNomCity As String
        Private mNomState As String
        Private mNomCountry As String
        Private mNomPincode As String
        Private mTrainedBy As String
        Private mTrainingDate As String
        Private mScore As String
        Private mCertifIssued As String
        Private mCertifDate As String
        Private mCertifNo As String
        Private mAppform As String
        Private mAppformName As String
        Private mAppformPath As String
        Private mpanno As String
        Private mpanname As String
        Private mpanpath As String
        Private maadharno As String
        Private maadharname As String
        Private maadharpath As String
        Private mpassportno As String
        Private mpassportname As String
        Private mpassportpath As String
        Private mdrvlicno As String
        Private mdrvlicname As String
        Private mdrvlicpath As String
        Private mGSTNNo As String
        Private mOthers As String
        Private mOthersName As String
        Private mOthersPath As String
        Private mOtherDetailVer As String
        Private mOtherDetailVerComm As String
        Private mSignVerify As String
        Private mSignVerifyComm As String
        Private mRemarks As String
        Public Shared ReportingToFromBlueBand As String
        '' Client Account
        Private mMartialStatus As String
        Private mPerBuss As String

        '' GP Registration Details
        Public Shared docno_RegID As String
        Private mSrno As String
        Private mRegID As String
        Private mRegDate As String
        Private mProgramID As String
        'Private mBatchID As String
        Private mProgramDate As String
        Private mProgramTime As String
        Private mloccd As String
        Private mVenueCode As String
        Private mTrainerCd As String
        Private mPlanName As String
        Private mGST As String
        Private mTDSDeducted As String
        Private mTotalAmount As String
        Private mTotalAmtAfterTDS As String
        Private mTotalAmtInWords As String
        Private mTypeOfPayment As String
        Private mPaymentOtherDetails As String
        Private mModeOfPayment As String
        Private mGrideTotalAmt As String
        Private mAdjAmount As String
        Private mBalAmt As String
        Private mCallDate As String
        Private mCallTime As String
        Private mComments As String
        Private mOtherDetVerify As String
        Private mOtherDetComments As String
        Private mRSignVerify As String
        Private mRSignComments As String
        Private mHR As String
        Private mMi As String
        Private mAP As String
        Private mBHR As String
        Private mBMi As String
        Private mBAP As String

        '' Client Registration Detials
        Private mRegType As String
        Private mJointAdmConactcd As String
        Private mServiceTax As String
        Private mCustPlanName As String
        Private mDateOfEntry As String
        Private mBatchID As String
        Private mBatchRegDate As String
        Private mBatchRegTime As String
        Private mBrHR As String
        Private mBrMi As String

        Private mSSPartName1 As String
        Private mSSPartDesignation1 As String
        Private mSSPartCompanyName1 As String
        Private mSSPartContactNo1 As String
        Private mSSPartRelationship1 As String
        Private mSSPartName2 As String
        Private mSSPartDesignation2 As String
        Private mSSPartCompanyName2 As String
        Private mSSPartContactNo2 As String
        Private mSSPartRelationship2 As String
        Private mempcdConst As String
        Private mInvoiceRemark As String

        Private mcrtuserid As String
        Private mcrtuserdt As String
        Private mmoduserid As String
        Private mmoduserdt As String

        Private mgstname As String
        Private mgstpath As String
        Private mbhcode As String
        Private mtallyrefno As String
        Private mUploadAttName As String
        Private mUploadAttPath As String
        Private minvdt As String

        Private minvoicingtype As String
        Private maddAttachmentName As String
        Private maddAttachmentPath As String

#Region "propery declaration"

        Public Property invoicingtype() As String
            Get
                Return minvoicingtype
            End Get
            Set(ByVal value As String)
                minvoicingtype = value
            End Set
        End Property

        Public Property addAttachmentName() As String
            Get
                Return maddAttachmentName
            End Get
            Set(ByVal value As String)
                maddAttachmentName = value
            End Set
        End Property

        Public Property addAttachmentPath() As String
            Get
                Return maddAttachmentPath
            End Get
            Set(ByVal value As String)
                maddAttachmentPath = value
            End Set
        End Property

        Public Property UploadAttName() As String
            Get
                Return mUploadAttName
            End Get
            Set(ByVal value As String)
                mUploadAttName = value
            End Set
        End Property

        Public Property UploadAttPath() As String
            Get
                Return mUploadAttPath
            End Get
            Set(ByVal value As String)
                mUploadAttPath = value
            End Set
        End Property

        Public Property tallyrefno() As String
            Get
                Return mtallyrefno
            End Get
            Set(ByVal value As String)
                mtallyrefno = value
            End Set
        End Property

        Public Property invdt() As String
            Get
                Return minvdt
            End Get
            Set(ByVal value As String)
                minvdt = value
            End Set
        End Property

        Public Property InvoiceRemark() As String
            Get
                Return mInvoiceRemark
            End Get
            Set(ByVal value As String)
                mInvoiceRemark = value
            End Set
        End Property

        Public Property SSPartName1() As String
            Get
                Return mSSPartName1
            End Get
            Set(ByVal value As String)
                mSSPartName1 = value
            End Set
        End Property

        Public Property SSPartDesignation1() As String
            Get
                Return mSSPartDesignation1
            End Get
            Set(ByVal value As String)
                mSSPartDesignation1 = value
            End Set
        End Property

        Public Property SSPartCompanyName1() As String
            Get
                Return mSSPartCompanyName1
            End Get
            Set(ByVal value As String)
                mSSPartCompanyName1 = value
            End Set
        End Property

        Public Property SSPartContactNo1() As String
            Get
                Return mSSPartContactNo1
            End Get
            Set(ByVal value As String)
                mSSPartContactNo1 = value
            End Set
        End Property

        Public Property SSPartRelationship1() As String
            Get
                Return mSSPartRelationship1
            End Get
            Set(ByVal value As String)
                mSSPartRelationship1 = value
            End Set
        End Property

        Public Property SSPartName2() As String
            Get
                Return mSSPartName2
            End Get
            Set(ByVal value As String)
                mSSPartName2 = value
            End Set
        End Property

        Public Property SSPartDesignation2() As String
            Get
                Return mSSPartDesignation2
            End Get
            Set(ByVal value As String)
                mSSPartDesignation2 = value
            End Set
        End Property

        Public Property SSPartCompanyName2() As String
            Get
                Return mSSPartCompanyName2
            End Get
            Set(ByVal value As String)
                mSSPartCompanyName2 = value
            End Set
        End Property

        Public Property SSPartContactNo2() As String
            Get
                Return mSSPartContactNo2
            End Get
            Set(ByVal value As String)
                mSSPartContactNo2 = value
            End Set
        End Property

        Public Property SSPartRelationship2() As String
            Get
                Return mSSPartRelationship2
            End Get
            Set(ByVal value As String)
                mSSPartRelationship2 = value
            End Set
        End Property

        Public Property empcdConst() As String
            Get
                Return mempcdConst
            End Get
            Set(ByVal value As String)
                mempcdConst = value
            End Set
        End Property

        Public Property BatchID() As String
            Get
                Return mBatchID
            End Get
            Set(ByVal value As String)
                mBatchID = value
            End Set
        End Property

        Public Property BatchRegDate() As String
            Get
                Return mBatchRegDate
            End Get
            Set(ByVal value As String)
                mBatchRegDate = value
            End Set
        End Property

        Public Property BatchRegTime() As String
            Get
                Return mBatchRegTime
            End Get
            Set(ByVal value As String)
                mBatchRegTime = value
            End Set
        End Property

        Public Property BrHR() As String
            Get
                Return mBrHR
            End Get
            Set(ByVal value As String)
                mBrHR = value
            End Set
        End Property

        Public Property BrMi() As String
            Get
                Return mBrMi
            End Get
            Set(ByVal value As String)
                mBrMi = value
            End Set
        End Property

        Public Property CustPlanName() As String
            Get
                Return mCustPlanName
            End Get
            Set(ByVal value As String)
                mCustPlanName = value
            End Set
        End Property

        Public Property DateOfEntry() As String
            Get
                Return mDateOfEntry
            End Get
            Set(ByVal value As String)
                mDateOfEntry = value
            End Set
        End Property

        Public Property ServiceTax() As String
            Get
                Return mServiceTax
            End Get
            Set(ByVal value As String)
                mServiceTax = value
            End Set
        End Property

        Public Property PerBuss() As String
            Get
                Return mPerBuss
            End Get
            Set(ByVal value As String)
                mPerBuss = value
            End Set
        End Property

        Public Property gpsourcecd() As String
            Get
                Return mgpsourcecd
            End Get
            Set(ByVal value As String)
                mgpsourcecd = value
            End Set
        End Property

        Public Property UserID() As String
            Get
                Return mUserID
            End Get
            Set(ByVal value As String)
                mUserID = value
            End Set
        End Property

        Public Property Password() As String
            Get
                Return mPassword
            End Get
            Set(ByVal value As String)
                mPassword = value
            End Set
        End Property

        Public Property SubIndustryCode() As String
            Get
                Return mSubIndustryCode
            End Get
            Set(ByVal value As String)
                mSubIndustryCode = value
            End Set
        End Property

        Public Property bhcode() As String
            Get
                Return mbhcode
            End Get
            Set(ByVal value As String)
                mbhcode = value
            End Set
        End Property

        Public Property gstname() As String
            Get
                Return mgstname
            End Get
            Set(ByVal value As String)
                mgstname = value
            End Set
        End Property

        Public Property gstpath() As String
            Get
                Return mgstpath
            End Get
            Set(ByVal value As String)
                mgstpath = value
            End Set
        End Property

        Public Property RegType() As String
            Get
                Return mRegType
            End Get
            Set(ByVal value As String)
                mRegType = value
            End Set
        End Property

        Public Property BHR() As String
            Get
                Return mBHR
            End Get
            Set(ByVal value As String)
                mBHR = value
            End Set
        End Property

        Public Property BMi() As String
            Get
                Return mBMi
            End Get
            Set(ByVal value As String)
                mBMi = value
            End Set
        End Property

        Public Property BAP() As String
            Get
                Return mBAP
            End Get
            Set(ByVal value As String)
                mBAP = value
            End Set
        End Property

        Public Property HR() As String
            Get
                Return mHR
            End Get
            Set(ByVal value As String)
                mHR = value
            End Set
        End Property

        Public Property Mi() As String
            Get
                Return mMi
            End Get
            Set(ByVal value As String)
                mMi = value
            End Set
        End Property

        Public Property AP() As String
            Get
                Return mAP
            End Get
            Set(ByVal value As String)
                mAP = value
            End Set
        End Property

        Public Property Srno() As String
            Get
                Return mSrno
            End Get
            Set(ByVal value As String)
                mSrno = value
            End Set
        End Property

        Public Property MartialStatus() As String
            Get
                Return mMartialStatus
            End Get
            Set(ByVal value As String)
                mMartialStatus = value
            End Set
        End Property

        Public Property Designation() As String
            Get
                Return mDesignation
            End Get
            Set(ByVal value As String)
                mDesignation = value
            End Set
        End Property

        Public Property productcd() As String
            Get
                Return mproductcd
            End Get
            Set(ByVal value As String)
                mproductcd = value
            End Set
        End Property

        Public Property leadindcd() As String
            Get
                Return mleadindcd
            End Get
            Set(ByVal value As String)
                mleadindcd = value
            End Set
        End Property

        Public Property crmIndustryTypecd() As String
            Get
                Return mcrmIndustryTypecd
            End Get
            Set(ByVal value As String)
                mcrmIndustryTypecd = value
            End Set
        End Property

        Public Property YearofEst() As String
            Get
                Return mYearofEst
            End Get
            Set(ByVal value As String)
                mYearofEst = value
            End Set
        End Property

        Public Property AnnualTurnover() As String
            Get
                Return mAnnualTurnover
            End Get
            Set(ByVal value As String)
                mAnnualTurnover = value
            End Set
        End Property

        Public Property NoofEmployeescd() As String
            Get
                Return mNoofEmployeescd
            End Get
            Set(ByVal value As String)
                mNoofEmployeescd = value
            End Set
        End Property

        Public Property qulificationcd() As String
            Get
                Return mqulificationcd
            End Get
            Set(ByVal value As String)
                mqulificationcd = value
            End Set
        End Property

        Public Property TypeOfEntity() As String
            Get
                Return mTypeOfEntity
            End Get
            Set(ByVal value As String)
                mTypeOfEntity = value
            End Set
        End Property

        Public Property BIProduct() As String
            Get
                Return mBIProduct
            End Get
            Set(ByVal value As String)
                mBIProduct = value
            End Set
        End Property

        Public Property MaritalStatus() As String
            Get
                Return mMaritalStatus
            End Get
            Set(ByVal value As String)
                mMaritalStatus = value
            End Set
        End Property

        Public Property dob() As String
            Get
                Return mdob
            End Get
            Set(ByVal value As String)
                mdob = value
            End Set
        End Property

        Public Property DOAnniversary() As String
            Get
                Return mDOAnniversary
            End Get
            Set(ByVal value As String)
                mDOAnniversary = value
            End Set
        End Property

        Public Property SpouceName() As String
            Get
                Return mSpouceName
            End Get
            Set(ByVal value As String)
                mSpouceName = value
            End Set
        End Property

        Public Property Religion() As String
            Get
                Return mReligion
            End Get
            Set(ByVal value As String)
                mReligion = value
            End Set
        End Property

        Public Property Nationality() As String
            Get
                Return mNationality
            End Get
            Set(ByVal value As String)
                mNationality = value
            End Set
        End Property

        Public Property MiddleName() As String
            Get
                Return mMiddleName
            End Get
            Set(ByVal value As String)
                mMiddleName = value
            End Set
        End Property

        Public Property QualificationStatus() As String
            Get
                Return mQualificationStatus
            End Get
            Set(ByVal value As String)
                mQualificationStatus = value
            End Set
        End Property

        Public Property RefFreeText() As String
            Get
                Return mRefFreeText
            End Get
            Set(ByVal value As String)
                mRefFreeText = value
            End Set
        End Property

        Public Property State() As String
            Get
                Return mState
            End Get
            Set(ByVal value As String)
                mState = value
            End Set
        End Property

        Public Property Country() As String
            Get
                Return mCountry
            End Get
            Set(ByVal value As String)
                mCountry = value
            End Set
        End Property

        Public Property segother() As String
            Get
                Return msegother
            End Get
            Set(ByVal value As String)
                msegother = value
            End Set
        End Property

        Public Property City() As String
            Get
                Return mCity
            End Get
            Set(ByVal value As String)
                mCity = value
            End Set
        End Property

        Public Property Gender() As String
            Get
                Return mGender
            End Get
            Set(ByVal value As String)
                mGender = value
            End Set
        End Property

        Public Property title() As String
            Get
                Return mtitle
            End Get
            Set(ByVal value As String)
                mtitle = value
            End Set
        End Property

        Public Property Location() As String
            Get
                Return mLocation
            End Get
            Set(ByVal value As String)
                mLocation = value
            End Set
        End Property

        Public Property refbyContactcd() As String
            Get
                Return mrefbyContactcd
            End Get
            Set(ByVal value As String)
                mrefbyContactcd = value
            End Set
        End Property

        Public Property Contactcd() As String
            Get
                Return mcontactcd
            End Get
            Set(ByVal value As String)
                mcontactcd = value
            End Set
        End Property

        Public Property Contactdate() As String
            Get
                Return mContactdate
            End Get
            Set(ByVal value As String)
                mContactdate = value
            End Set
        End Property

        Public Property ltypecd() As String
            Get
                Return mltypecd
            End Get
            Set(ByVal value As String)
                mltypecd = value
            End Set
        End Property

        Public Property Sourcecd() As String
            Get
                Return mSourcecd
            End Get
            Set(ByVal value As String)
                mSourcecd = value
            End Set
        End Property

        Public Property CompanyName() As String
            Get
                Return mcompanyname
            End Get
            Set(ByVal value As String)
                mcompanyname = value
            End Set
        End Property

        Public Property Segmentcd() As String
            Get
                Return mSegmentcd
            End Get
            Set(ByVal value As String)
                mSegmentcd = value
            End Set
        End Property

        Public Property Contactname() As String
            Get
                Return mcontactname
            End Get
            Set(ByVal value As String)
                mcontactname = value
            End Set
        End Property

        Public Property LeadTypecd() As String
            Get
                Return mltypecd
            End Get
            Set(ByVal value As String)
                mltypecd = value
            End Set
        End Property

        Public Property Email() As String
            Get
                Return memail
            End Get
            Set(ByVal value As String)
                memail = value
            End Set
        End Property

        Public Property Add1() As String
            Get
                Return mAdd1
            End Get
            Set(ByVal value As String)
                mAdd1 = value
            End Set
        End Property

        Public Property Email2() As String
            Get
                Return mEmail2
            End Get
            Set(ByVal value As String)
                mEmail2 = value
            End Set
        End Property

        Public Property Pincode() As String
            Get
                Return mPincode
            End Get
            Set(ByVal value As String)
                mPincode = value
            End Set
        End Property

        Public Property mobile2() As String
            Get
                Return mmobile2
            End Get
            Set(ByVal value As String)
                mmobile2 = value
            End Set
        End Property

        Public Property Mobile() As String
            Get
                Return mmobile
            End Get
            Set(ByVal value As String)
                mmobile = value
            End Set
        End Property

        Public Property LastName() As String
            Get
                Return mLastName
            End Get
            Set(ByVal value As String)
                mLastName = value
            End Set
        End Property

        Public Property street() As String
            Get
                Return mstreet
            End Get
            Set(ByVal value As String)
                mstreet = value
            End Set
        End Property

        Public Property statuscd() As String
            Get
                Return mstatuscd
            End Get
            Set(ByVal value As String)
                mstatuscd = value
            End Set
        End Property

        Public Property Office1() As String
            Get
                Return mOffice1
            End Get
            Set(ByVal value As String)
                mOffice1 = value
            End Set
        End Property

        Public Property Office2() As String
            Get
                Return mOffice2
            End Get
            Set(ByVal value As String)
                mOffice2 = value
            End Set
        End Property

        Public Property Home1() As String
            Get
                Return mHome1
            End Get
            Set(ByVal value As String)
                mHome1 = value
            End Set
        End Property

        Public Property Home2() As String
            Get
                Return mHome2
            End Get
            Set(ByVal value As String)
                mHome2 = value
            End Set
        End Property

        '' GP Account
        Public Property ApplicatinDate() As String
            Get
                Return mApplicatinDate
            End Get
            Set(ByVal value As String)
                mApplicatinDate = value
            End Set
        End Property
        Public Property Photo() As String
            Get
                Return mPhoto
            End Get
            Set(ByVal value As String)
                mPhoto = value
            End Set
        End Property
        Public Property GPCode() As String
            Get
                Return mGPCode
            End Get
            Set(ByVal value As String)
                mGPCode = value
            End Set
        End Property
        Public Property Photopath() As String
            Get
                Return mPhotopath
            End Get
            Set(ByVal value As String)
                mPhotopath = value
            End Set
        End Property
        Public Property BankAccNo() As String
            Get
                Return mBankAccNo
            End Get
            Set(ByVal value As String)
                mBankAccNo = value
            End Set
        End Property
        Public Property BankAccType() As String
            Get
                Return mBankAccType
            End Get
            Set(ByVal value As String)
                mBankAccType = value
            End Set
        End Property
        Public Property BankName() As String
            Get
                Return mBankName
            End Get
            Set(ByVal value As String)
                mBankName = value
            End Set
        End Property
        Public Property Branch() As String
            Get
                Return mBranch
            End Get
            Set(ByVal value As String)
                mBranch = value
            End Set
        End Property
        Public Property BankCity() As String
            Get
                Return mBankCity
            End Get
            Set(ByVal value As String)
                mBankCity = value
            End Set
        End Property
        Public Property IFSCCode() As String
            Get
                Return mIFSCCode
            End Get
            Set(ByVal value As String)
                mIFSCCode = value
            End Set
        End Property
        Public Property NomTitle() As String
            Get
                Return mNomTitle
            End Get
            Set(ByVal value As String)
                mNomTitle = value
            End Set
        End Property
        Public Property NomFirstName() As String
            Get
                Return mNomFirstName
            End Get
            Set(ByVal value As String)
                mNomFirstName = value
            End Set
        End Property

        Public Property NomMiddleName() As String
            Get
                Return mNomMiddleName
            End Get
            Set(ByVal value As String)
                mNomMiddleName = value
            End Set
        End Property

        Public Property NomLastName() As String
            Get
                Return mNomLastName
            End Get
            Set(ByVal value As String)
                mNomLastName = value
            End Set
        End Property

        Public Property NomRelationship() As String
            Get
                Return mNomRelationship
            End Get
            Set(ByVal value As String)
                mNomRelationship = value
            End Set
        End Property

        Public Property NomDOB() As String
            Get
                Return mNomDOB
            End Get
            Set(ByVal value As String)
                mNomDOB = value
            End Set
        End Property

        Public Property NomMobile() As String
            Get
                Return mNomMobile
            End Get
            Set(ByVal value As String)
                mNomMobile = value
            End Set
        End Property

        Public Property NomHomePhoneNo() As String
            Get
                Return mNomHomePhoneNo
            End Get
            Set(ByVal value As String)
                mNomHomePhoneNo = value
            End Set
        End Property

        Public Property NomEmail() As String
            Get
                Return mNomEmail
            End Get
            Set(ByVal value As String)
                mNomEmail = value
            End Set
        End Property

        Public Property NomAdd() As String
            Get
                Return mNomAdd
            End Get
            Set(ByVal value As String)
                mNomAdd = value
            End Set
        End Property

        Public Property NomStreet() As String
            Get
                Return mNomStreet
            End Get
            Set(ByVal value As String)
                mNomStreet = value
            End Set
        End Property

        Public Property NomLocation() As String
            Get
                Return mNomLocation
            End Get
            Set(ByVal value As String)
                mNomLocation = value
            End Set
        End Property

        Public Property NomCity() As String
            Get
                Return mNomCity
            End Get
            Set(ByVal value As String)
                mNomCity = value
            End Set
        End Property

        Public Property NomState() As String
            Get
                Return mNomState
            End Get
            Set(ByVal value As String)
                mNomState = value
            End Set
        End Property

        Public Property NomCountry() As String
            Get
                Return mNomCountry
            End Get
            Set(ByVal value As String)
                mNomCountry = value
            End Set
        End Property

        Public Property NomPincode() As String
            Get
                Return mNomPincode
            End Get
            Set(ByVal value As String)
                mNomPincode = value
            End Set
        End Property

        Public Property TrainedBy() As String
            Get
                Return mTrainedBy
            End Get
            Set(ByVal value As String)
                mTrainedBy = value
            End Set
        End Property

        Public Property TrainingDate() As String
            Get
                Return mTrainingDate
            End Get
            Set(ByVal value As String)
                mTrainingDate = value
            End Set
        End Property

        Public Property Score() As String
            Get
                Return mScore
            End Get
            Set(ByVal value As String)
                mScore = value
            End Set
        End Property

        Public Property CertifIssued() As String
            Get
                Return mCertifIssued
            End Get
            Set(ByVal value As String)
                mCertifIssued = value
            End Set
        End Property

        Public Property CertifDate() As String
            Get
                Return mCertifDate
            End Get
            Set(ByVal value As String)
                mCertifDate = value
            End Set
        End Property
        Public Property CertifNo() As String
            Get
                Return mCertifNo
            End Get
            Set(ByVal value As String)
                mCertifNo = value
            End Set
        End Property

        Public Property Appform() As String
            Get
                Return mAppform
            End Get
            Set(ByVal value As String)
                mAppform = value
            End Set
        End Property

        Public Property AppformName() As String
            Get
                Return mAppformName
            End Get
            Set(ByVal value As String)
                mAppformName = value
            End Set
        End Property

        Public Property AppformPath() As String
            Get
                Return mAppformPath
            End Get
            Set(ByVal value As String)
                mAppformPath = value
            End Set
        End Property

        Public Property panno() As String
            Get
                Return mpanno
            End Get
            Set(ByVal value As String)
                mpanno = value
            End Set
        End Property

        Public Property panname() As String
            Get
                Return mpanname
            End Get
            Set(ByVal value As String)
                mpanname = value
            End Set
        End Property

        Public Property panpath() As String
            Get
                Return mpanpath
            End Get
            Set(ByVal value As String)
                mpanpath = value
            End Set
        End Property

        Public Property aadharno() As String
            Get
                Return maadharno
            End Get
            Set(ByVal value As String)
                maadharno = value
            End Set
        End Property

        Public Property aadharname() As String
            Get
                Return maadharname
            End Get
            Set(ByVal value As String)
                maadharname = value
            End Set

        End Property
        Public Property aadharpath() As String
            Get
                Return maadharpath
            End Get
            Set(ByVal value As String)
                maadharpath = value
            End Set
        End Property

        Public Property passportno() As String
            Get
                Return mpassportno
            End Get
            Set(ByVal value As String)
                mpassportno = value
            End Set

        End Property
        Public Property passportname() As String
            Get
                Return mpassportname
            End Get
            Set(ByVal value As String)
                mpassportname = value
            End Set
        End Property

        Public Property passportpath() As String
            Get
                Return mpassportpath
            End Get
            Set(ByVal value As String)
                mpassportpath = value
            End Set
        End Property

        Public Property drvlicno() As String
            Get
                Return mdrvlicno
            End Get
            Set(ByVal value As String)
                mdrvlicno = value
            End Set

        End Property
        Public Property drvlicname() As String
            Get
                Return mdrvlicname
            End Get
            Set(ByVal value As String)
                mdrvlicname = value
            End Set
        End Property

        Public Property drvlicpath() As String
            Get
                Return mdrvlicname
            End Get
            Set(ByVal value As String)
                mdrvlicname = value
            End Set

        End Property
        Public Property GSTNNo() As String
            Get
                Return mGSTNNo
            End Get
            Set(ByVal value As String)
                mGSTNNo = value
            End Set
        End Property

        Public Property Others() As String
            Get
                Return mOthers
            End Get
            Set(ByVal value As String)
                mOthers = value
            End Set
        End Property

        Public Property OthersName() As String
            Get
                Return mOthersName
            End Get
            Set(ByVal value As String)
                mOthersName = value
            End Set
        End Property

        Public Property OthersPath() As String
            Get
                Return mOthersPath
            End Get
            Set(ByVal value As String)
                mOthersPath = value
            End Set
        End Property

        Public Property OtherDetailVer() As String
            Get
                Return mOtherDetailVer
            End Get
            Set(ByVal value As String)
                mOtherDetailVer = value
            End Set
        End Property

        Public Property OtherDetailVerComm() As String
            Get
                Return mOtherDetailVerComm
            End Get
            Set(ByVal value As String)
                mOtherDetailVerComm = value
            End Set
        End Property

        Public Property SignVerify() As String
            Get
                Return mSignVerify
            End Get
            Set(ByVal value As String)
                mSignVerify = value
            End Set
        End Property

        Public Property SignVerifyComm() As String
            Get
                Return mSignVerifyComm
            End Get
            Set(ByVal value As String)
                mSignVerifyComm = value
            End Set
        End Property

        Public Property Remarks() As String
            Get
                Return mRemarks
            End Get
            Set(ByVal value As String)
                mRemarks = value
            End Set
        End Property
        '' End GP Account

        '' Start GP Registration Details
        Public Property RegID() As String
            Get
                Return mRegID
            End Get
            Set(ByVal value As String)
                mRegID = value
            End Set
        End Property

        Public Property RegDate() As String
            Get
                Return mRegDate
            End Get
            Set(ByVal value As String)
                mRegDate = value
            End Set
        End Property

        Public Property ProgramID() As String
            Get
                Return mProgramID
            End Get
            Set(ByVal value As String)
                mProgramID = value
            End Set
        End Property

        'Public Property BatchID() As String
        '    Get
        '        Return mBatchID
        '    End Get
        '    Set(ByVal value As String)
        '        mBatchID = value
        '    End Set
        'End Property

        Public Property ProgramDate() As String
            Get
                Return mProgramDate
            End Get
            Set(ByVal value As String)
                mProgramDate = value
            End Set
        End Property

        Public Property ProgramTime() As String
            Get
                Return mProgramTime
            End Get
            Set(ByVal value As String)
                mProgramTime = value
            End Set
        End Property

        Public Property loccd() As String
            Get
                Return mloccd
            End Get
            Set(ByVal value As String)
                mloccd = value
            End Set
        End Property

        Public Property VenueCode() As String
            Get
                Return mVenueCode
            End Get
            Set(ByVal value As String)
                mVenueCode = value
            End Set
        End Property

        Public Property TrainerCd() As String
            Get
                Return mTrainerCd
            End Get
            Set(ByVal value As String)
                mTrainerCd = value
            End Set
        End Property

        Public Property PlanName() As String
            Get
                Return mPlanName
            End Get
            Set(ByVal value As String)
                mPlanName = value
            End Set
        End Property

        Public Property GST() As String
            Get
                Return mGST
            End Get
            Set(ByVal value As String)
                mGST = value
            End Set
        End Property

        Public Property TDSDeducted() As String
            Get
                Return mTDSDeducted
            End Get
            Set(ByVal value As String)
                mTDSDeducted = value
            End Set
        End Property

        Public Property TotalAmount() As String
            Get
                Return mTotalAmount
            End Get
            Set(ByVal value As String)
                mTotalAmount = value
            End Set
        End Property

        Public Property TotalAmtAfterTDS() As String
            Get
                Return mTotalAmtAfterTDS
            End Get
            Set(ByVal value As String)
                mTotalAmtAfterTDS = value
            End Set
        End Property

        Public Property TotalAmtInWords() As String
            Get
                Return mTotalAmtInWords
            End Get
            Set(ByVal value As String)
                mTotalAmtInWords = value
            End Set
        End Property

        Public Property TypeOfPayment() As String
            Get
                Return mTypeOfPayment
            End Get
            Set(ByVal value As String)
                mTypeOfPayment = value
            End Set
        End Property

        Public Property PaymentOtherDetails() As String
            Get
                Return mPaymentOtherDetails
            End Get
            Set(ByVal value As String)
                mPaymentOtherDetails = value
            End Set
        End Property

        Public Property ModeOfPayment() As String
            Get
                Return mModeOfPayment
            End Get
            Set(ByVal value As String)
                mModeOfPayment = value
            End Set
        End Property

        Public Property GrideTotalAmt() As String
            Get
                Return mGrideTotalAmt
            End Get
            Set(ByVal value As String)
                mGrideTotalAmt = value
            End Set
        End Property

        Public Property AdjAmount() As String
            Get
                Return mAdjAmount
            End Get
            Set(ByVal value As String)
                mAdjAmount = value
            End Set
        End Property

        Public Property BalAmt() As String
            Get
                Return mBalAmt
            End Get
            Set(ByVal value As String)
                mBalAmt = value
            End Set
        End Property

        Public Property CallDate() As String
            Get
                Return mCallDate
            End Get
            Set(ByVal value As String)
                mCallDate = value
            End Set
        End Property

        Public Property CallTime() As String
            Get
                Return mCallTime
            End Get
            Set(ByVal value As String)
                mCallTime = value
            End Set
        End Property

        Public Property Comments() As String
            Get
                Return mComments
            End Get
            Set(ByVal value As String)
                mComments = value
            End Set
        End Property

        Public Property OtherDetVerify() As String
            Get
                Return mOtherDetVerify
            End Get
            Set(ByVal value As String)
                mOtherDetVerify = value
            End Set
        End Property

        Public Property OtherDetComments() As String
            Get
                Return mOtherDetComments
            End Get
            Set(ByVal value As String)
                mOtherDetComments = value
            End Set
        End Property

        Public Property RSignVerify() As String
            Get
                Return mRSignVerify
            End Get
            Set(ByVal value As String)
                mRSignVerify = value
            End Set
        End Property

        Public Property RSignComments() As String
            Get
                Return mRSignComments
            End Get
            Set(ByVal value As String)
                mRSignComments = value
            End Set
        End Property

        Public Property JointAdmConactcd() As String
            Get
                Return mJointAdmConactcd
            End Get
            Set(ByVal value As String)
                mJointAdmConactcd = value
            End Set
        End Property
        '' End GP Registratoin Details

        Public Property crtuserid() As String
            Get
                Return mcrtuserid
            End Get
            Set(ByVal value As String)
                mcrtuserid = value
            End Set
        End Property
        Public Property crtuserdt() As String
            Get
                Return mcrtuserdt
            End Get
            Set(ByVal value As String)
                mcrtuserdt = value
            End Set
        End Property
        Public Property moduserid() As String
            Get
                Return mmoduserid
            End Get
            Set(ByVal value As String)
                mmoduserid = value
            End Set
        End Property
        Public Property moduserdt() As String
            Get
                Return mmoduserdt
            End Get
            Set(ByVal value As String)
                mmoduserdt = value
            End Set
        End Property

#End Region

        '' Start Dash Borad
        Public Shared Function Get_wishlist() As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                Dim dt As DataTable = db.ExecuteDataTable("Sp_wishlist_Getdata")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Get_appointments(ByVal empcdFromLogin As String, ByVal loccd As String, ByVal designationcode As String, ByVal empcd As String) As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@empcdFromLogin", empcdFromLogin))
                db.Parameters.Add(New SqlParameter("@loccd", loccd))
                db.Parameters.Add(New SqlParameter("@designationcode", designationcode))
                db.Parameters.Add(New SqlParameter("@empcd", empcd))
                Dim dt As DataTable = db.ExecuteDataTable("Sp_Appointment_Getdata")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        '' Start GP Details
        'Public Shared Function GetDataAll_GP(ByVal contactcd As String, ByVal ltypecd As String, ByVal areacd As String, ByVal Flag As String, ByVal UserID As String, ByVal loccd As String) As DataTable
        '    Try
        '        Dim db As DBAccess = New DBAccess
        '        db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
        '        db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
        '        db.Parameters.Add(New SqlParameter("@areacd", areacd))
        '        db.Parameters.Add(New SqlParameter("@Flag", Flag))
        '        db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
        '        db.Parameters.Add(New SqlParameter("@loccd", loccd))

        '        Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData")
        '        Return dt
        '    Catch ex As Exception
        '        Throw ex
        '    End Try
        'End Function

        'Public Shared Function GetDataAll_Client(ByVal contactcd As String, ByVal ltypecd As String, ByVal areacd As String, ByVal Flag As String, ByVal UserID As String, ByVal loccd As String) As DataTable
        '    Try
        '        Dim db As DBAccess = New DBAccess
        '        db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
        '        db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
        '        db.Parameters.Add(New SqlParameter("@areacd", areacd))
        '        db.Parameters.Add(New SqlParameter("@Flag", Flag))
        '        db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
        '        db.Parameters.Add(New SqlParameter("@loccd", loccd))

        '        Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData")
        '        Return dt
        '    Catch ex As Exception
        '        Throw ex
        '    End Try
        'End Function

        Public Shared Function GetDataAll_GP_IMP(ByVal Statuscd As String, ByVal open As String, ByVal empcd As String, ByVal ActionDate As String, ByVal contactcd As String, ByVal ltypecd As String, ByVal Flag As String, ByVal UserID As String, ByVal loccd As String, ByVal leadindcd As String, ByVal SubIndustryCode As String) As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@Statuscd", Statuscd))
                db.Parameters.Add(New SqlParameter("@open", open))
                db.Parameters.Add(New SqlParameter("@empcd", empcd))
                db.Parameters.Add(New SqlParameter("@ActionDate", ActionDate))
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))
                db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
                db.Parameters.Add(New SqlParameter("@loccd", loccd))
                db.Parameters.Add(New SqlParameter("@leadindcd", leadindcd))
                db.Parameters.Add(New SqlParameter("@SubIndustryCode", SubIndustryCode))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData_IMP")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function GetDataAll_GP(ByVal Statuscd As String, ByVal open As String, ByVal empcd As String, ByVal ActionDate As String, ByVal contactcd As String, ByVal ltypecd As String, ByVal Flag As String, ByVal UserID As String, ByVal loccd As String, ByVal leadindcd As String, ByVal SubIndustryCode As String, ByVal fromdt As String, ByVal todt As String) As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@Statuscd", Statuscd))
                db.Parameters.Add(New SqlParameter("@open", open))
                db.Parameters.Add(New SqlParameter("@empcd", empcd))
                db.Parameters.Add(New SqlParameter("@ActionDate", ActionDate))
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))
                db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
                db.Parameters.Add(New SqlParameter("@loccd", loccd))
                db.Parameters.Add(New SqlParameter("@leadindcd", leadindcd))
                db.Parameters.Add(New SqlParameter("@SubIndustryCode", SubIndustryCode))
                db.Parameters.Add(New SqlParameter("@fromdt", fromdt))
                db.Parameters.Add(New SqlParameter("@todt", todt))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function GetDataAll_GP_BC(ByVal Statuscd As String, ByVal open As String, ByVal empcd As String, ByVal ActionDate As String, ByVal contactcd As String, ByVal ltypecd As String, ByVal Flag As String, ByVal UserID As String, ByVal loccd As String, ByVal leadindcd As String, ByVal SubIndustryCode As String, ByVal fromdt As String, ByVal todt As String) As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@Statuscd", Statuscd))
                db.Parameters.Add(New SqlParameter("@open", open))
                db.Parameters.Add(New SqlParameter("@empcd", empcd))
                db.Parameters.Add(New SqlParameter("@ActionDate", ActionDate))
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))
                db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
                db.Parameters.Add(New SqlParameter("@loccd", loccd))
                db.Parameters.Add(New SqlParameter("@leadindcd", leadindcd))
                db.Parameters.Add(New SqlParameter("@SubIndustryCode", SubIndustryCode))
                db.Parameters.Add(New SqlParameter("@fromdt", fromdt))
                db.Parameters.Add(New SqlParameter("@todt", todt))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData_BC")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function FillData_GP(ByVal contactcd As String, ByVal ltypecd As String, ByVal areacd As String, ByVal Flag As String, ByVal UserID As String) As ClsCRMContactForGPAndClient_All_New
            Try
                Dim db As DBAccess = New DBAccess
                'db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                'db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
                'db.Parameters.Add(New SqlParameter("@areacd", areacd))
                'db.Parameters.Add(New SqlParameter("@Flag", Flag))
                'db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
                'db.Parameters.Add(New SqlParameter("@loccd", ""))

                db.Parameters.Add(New SqlParameter("@Statuscd", ""))
                db.Parameters.Add(New SqlParameter("@open", ""))
                db.Parameters.Add(New SqlParameter("@empcd", ""))
                db.Parameters.Add(New SqlParameter("@ActionDate", ""))
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))
                db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
                db.Parameters.Add(New SqlParameter("@loccd", ""))
                db.Parameters.Add(New SqlParameter("@leadindcd", ""))
                db.Parameters.Add(New SqlParameter("@SubIndustryCode", ""))
                db.Parameters.Add(New SqlParameter("@fromdt", ""))
                db.Parameters.Add(New SqlParameter("@todt", ""))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData")
                If dt.Rows.Count > 0 Then
                    Dim obj As ClsCRMContactForGPAndClient_All_New = New ClsCRMContactForGPAndClient_All_New
                    '' GP Detail
                    If Not IsDBNull(dt.Rows(0)("contactcd")) Then
                        obj.Contactcd = dt.Rows(0)("contactcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("date").ToString) Then
                        obj.Contactdate = ""
                    Else
                        obj.Contactdate = dt.Rows(0)("date").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ltypecd").ToString) Then
                        obj.ltypecd = ""
                    Else
                        obj.ltypecd = dt.Rows(0)("ltypecd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("title").ToString) Then
                        obj.title = ""
                    Else
                        obj.title = dt.Rows(0)("title").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("contactname").ToString) Then
                        obj.Contactname = ""
                    Else
                        obj.Contactname = dt.Rows(0)("contactname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("MiddleName").ToString) Then
                        obj.MiddleName = ""
                    Else
                        obj.MiddleName = dt.Rows(0)("MiddleName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("LastName").ToString) Then
                        obj.LastName = ""
                    Else
                        obj.LastName = dt.Rows(0)("LastName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Gender").ToString) Then
                        obj.Gender = ""
                    Else
                        obj.Gender = dt.Rows(0)("Gender").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("companyname").ToString) Then
                        obj.CompanyName = ""
                    Else
                        obj.CompanyName = dt.Rows(0)("companyname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Segmentcd").ToString) Then
                        obj.Segmentcd = ""
                    Else
                        obj.Segmentcd = dt.Rows(0)("Segmentcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("segother").ToString) Then
                        obj.segother = ""
                    Else
                        obj.segother = dt.Rows(0)("segother").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("dob").ToString) Then
                        obj.dob = ""
                    Else
                        obj.dob = dt.Rows(0)("dob").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("MaritalStatus").ToString) Then
                        obj.MaritalStatus = ""
                    Else
                        obj.MaritalStatus = dt.Rows(0)("MaritalStatus").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SpouceName").ToString) Then
                        obj.SpouceName = ""
                    Else
                        obj.SpouceName = dt.Rows(0)("SpouceName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("DOAnniversary").ToString) Then
                        obj.DOAnniversary = ""
                    Else
                        obj.DOAnniversary = dt.Rows(0)("DOAnniversary").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Religion").ToString) Then
                        obj.Religion = ""
                    Else
                        obj.Religion = dt.Rows(0)("Religion").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Nationality").ToString) Then
                        obj.Nationality = ""
                    Else
                        obj.Nationality = dt.Rows(0)("Nationality").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("QualificationStatus").ToString) Then
                        obj.QualificationStatus = ""
                    Else
                        obj.QualificationStatus = dt.Rows(0)("QualificationStatus").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Sourcecd").ToString) Then
                        obj.Sourcecd = ""
                    Else
                        obj.Sourcecd = dt.Rows(0)("Sourcecd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("refbyContactcd").ToString) Then
                        obj.refbyContactcd = ""
                    Else
                        obj.refbyContactcd = dt.Rows(0)("refbyContactcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RefFreeText").ToString) Then
                        obj.RefFreeText = ""
                    Else
                        obj.RefFreeText = dt.Rows(0)("RefFreeText").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("UserID").ToString) Then
                        obj.UserID = ""
                    Else
                        obj.UserID = dt.Rows(0)("UserID").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Password").ToString) Then
                        obj.Password = ""
                    Else
                        obj.Password = dt.Rows(0)("Password").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("mobile").ToString) Then
                        obj.Mobile = ""
                    Else
                        obj.Mobile = dt.Rows(0)("mobile").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("mobile2").ToString) Then
                        obj.mobile2 = ""
                    Else
                        obj.mobile2 = dt.Rows(0)("mobile2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Office1").ToString) Then
                        obj.Office1 = ""
                    Else
                        obj.Office1 = dt.Rows(0)("Office1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Office2").ToString) Then
                        obj.Office2 = ""
                    Else
                        obj.Office2 = dt.Rows(0)("Office2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Home1").ToString) Then
                        obj.Home1 = ""
                    Else
                        obj.Home1 = dt.Rows(0)("Home1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Home2").ToString) Then
                        obj.Home2 = ""
                    Else
                        obj.Home2 = dt.Rows(0)("Home2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("email").ToString) Then
                        obj.Email = ""
                    Else
                        obj.Email = dt.Rows(0)("email").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Email2").ToString) Then
                        obj.Email2 = ""
                    Else
                        obj.Email2 = dt.Rows(0)("Email2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Add1").ToString) Then
                        obj.Add1 = ""
                    Else
                        obj.Add1 = dt.Rows(0)("Add1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("street").ToString) Then
                        obj.street = ""
                    Else
                        obj.street = dt.Rows(0)("street").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Location").ToString) Then
                        obj.Location = ""
                    Else
                        obj.Location = dt.Rows(0)("Location").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("City").ToString) Then
                        obj.City = ""
                    Else
                        obj.City = dt.Rows(0)("City").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("State").ToString) Then
                        obj.State = ""
                    Else
                        obj.State = dt.Rows(0)("State").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Country").ToString) Then
                        obj.Country = ""
                    Else
                        obj.Country = dt.Rows(0)("Country").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Pincode").ToString) Then
                        obj.Pincode = ""
                    Else
                        obj.Pincode = dt.Rows(0)("Pincode").ToString
                    End If

                    '' GP Account
                    If IsDBNull(dt.Rows(0)("ApplicatinDate").ToString) Then
                        obj.ApplicatinDate = ""
                    Else
                        obj.ApplicatinDate = dt.Rows(0)("ApplicatinDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GPCode").ToString) Then
                        obj.GPCode = ""
                    Else
                        obj.GPCode = dt.Rows(0)("GPCode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Photo").ToString) Then
                        obj.Photo = ""
                    Else
                        obj.Photo = dt.Rows(0)("Photo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Photopath").ToString) Then
                        obj.Photopath = ""
                    Else
                        obj.Photopath = dt.Rows(0)("Photopath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankAccNo").ToString) Then
                        obj.BankAccNo = ""
                    Else
                        obj.BankAccNo = dt.Rows(0)("BankAccNo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankAccType").ToString) Then
                        obj.BankAccType = ""
                    Else
                        obj.BankAccType = dt.Rows(0)("BankAccType").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankName").ToString) Then
                        obj.BankName = ""
                    Else
                        obj.BankName = dt.Rows(0)("BankName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Branch").ToString) Then
                        obj.Branch = ""
                    Else
                        obj.Branch = dt.Rows(0)("Branch").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankCity").ToString) Then
                        obj.BankCity = ""
                    Else
                        obj.BankCity = dt.Rows(0)("BankCity").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("IFSCCode").ToString) Then
                        obj.IFSCCode = ""
                    Else
                        obj.IFSCCode = dt.Rows(0)("IFSCCode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomTitle").ToString) Then
                        obj.NomTitle = ""
                    Else
                        obj.NomTitle = dt.Rows(0)("NomTitle").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomFirstName").ToString) Then
                        obj.NomFirstName = ""
                    Else
                        obj.NomFirstName = dt.Rows(0)("NomFirstName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomMiddleName").ToString) Then
                        obj.NomMiddleName = ""
                    Else
                        obj.NomMiddleName = dt.Rows(0)("NomMiddleName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomLastName").ToString) Then
                        obj.NomLastName = ""
                    Else
                        obj.NomLastName = dt.Rows(0)("NomLastName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomRelationship").ToString) Then
                        obj.NomRelationship = ""
                    Else
                        obj.NomRelationship = dt.Rows(0)("NomRelationship").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomDOB").ToString) Then
                        obj.NomDOB = ""
                    Else
                        obj.NomDOB = dt.Rows(0)("NomDOB").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomMobile").ToString) Then
                        obj.NomMobile = ""
                    Else
                        obj.NomMobile = dt.Rows(0)("NomMobile").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomHomePhoneNo").ToString) Then
                        obj.NomHomePhoneNo = ""
                    Else
                        obj.NomHomePhoneNo = dt.Rows(0)("NomHomePhoneNo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomEmail").ToString) Then
                        obj.NomEmail = ""
                    Else
                        obj.NomEmail = dt.Rows(0)("NomEmail").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomAdd").ToString) Then
                        obj.NomAdd = ""
                    Else
                        obj.NomAdd = dt.Rows(0)("NomAdd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomStreet").ToString) Then
                        obj.NomStreet = ""
                    Else
                        obj.NomStreet = dt.Rows(0)("NomStreet").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomLocation").ToString) Then
                        obj.NomLocation = ""
                    Else
                        obj.NomLocation = dt.Rows(0)("NomLocation").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomCity").ToString) Then
                        obj.NomCity = ""
                    Else
                        obj.NomCity = dt.Rows(0)("NomCity").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomState").ToString) Then
                        obj.NomState = ""
                    Else
                        obj.NomState = dt.Rows(0)("NomState").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomCountry").ToString) Then
                        obj.NomCountry = ""
                    Else
                        obj.NomCountry = dt.Rows(0)("NomCountry").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomPincode").ToString) Then
                        obj.NomPincode = ""
                    Else
                        obj.NomPincode = dt.Rows(0)("NomPincode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TrainedBy").ToString) Then
                        obj.TrainedBy = ""
                    Else
                        obj.TrainedBy = dt.Rows(0)("TrainedBy").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TrainingDate").ToString) Then
                        obj.TrainingDate = ""
                    Else
                        obj.TrainingDate = dt.Rows(0)("TrainingDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Score").ToString) Then
                        obj.Score = ""
                    Else
                        obj.Score = dt.Rows(0)("Score").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CertifIssued").ToString) Then
                        obj.CertifIssued = ""
                    Else
                        obj.CertifIssued = dt.Rows(0)("CertifIssued").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CertifDate").ToString) Then
                        obj.CertifDate = ""
                    Else
                        obj.CertifDate = dt.Rows(0)("CertifDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CertifNo").ToString) Then
                        obj.CertifNo = ""
                    Else
                        obj.CertifNo = dt.Rows(0)("CertifNo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Appform").ToString) Then
                        obj.Appform = ""
                    Else
                        obj.Appform = dt.Rows(0)("Appform").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AppformName").ToString) Then
                        obj.AppformName = ""
                    Else
                        obj.AppformName = dt.Rows(0)("AppformName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AppformPath").ToString) Then
                        obj.AppformPath = ""
                    Else
                        obj.AppformPath = dt.Rows(0)("AppformPath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("panno").ToString) Then
                        obj.panno = ""
                    Else
                        obj.panno = dt.Rows(0)("panno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("panname").ToString) Then
                        obj.panname = ""
                    Else
                        obj.panname = dt.Rows(0)("panname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("panpath").ToString) Then
                        obj.panpath = ""
                    Else
                        obj.panpath = dt.Rows(0)("panpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("aadharno").ToString) Then
                        obj.aadharno = ""
                    Else
                        obj.aadharno = dt.Rows(0)("aadharno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("aadharname").ToString) Then
                        obj.aadharname = ""
                    Else
                        obj.aadharname = dt.Rows(0)("aadharname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("aadharpath").ToString) Then
                        obj.aadharpath = ""
                    Else
                        obj.aadharpath = dt.Rows(0)("aadharpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("passportno").ToString) Then
                        obj.passportno = ""
                    Else
                        obj.passportno = dt.Rows(0)("passportno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("passportname").ToString) Then
                        obj.passportname = ""
                    Else
                        obj.passportname = dt.Rows(0)("passportname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("passportpath").ToString) Then
                        obj.passportpath = ""
                    Else
                        obj.passportpath = dt.Rows(0)("passportpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("drvlicno").ToString) Then
                        obj.drvlicno = ""
                    Else
                        obj.drvlicno = dt.Rows(0)("drvlicno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("drvlicname").ToString) Then
                        obj.drvlicname = ""
                    Else
                        obj.drvlicname = dt.Rows(0)("drvlicname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("drvlicpath").ToString) Then
                        obj.drvlicpath = ""
                    Else
                        obj.drvlicpath = dt.Rows(0)("drvlicpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GSTNNo").ToString) Then
                        obj.GSTNNo = ""
                    Else
                        obj.GSTNNo = dt.Rows(0)("GSTNNo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Others").ToString) Then
                        obj.Others = ""
                    Else
                        obj.Others = dt.Rows(0)("Others").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OthersName").ToString) Then
                        obj.OthersName = ""
                    Else
                        obj.OthersName = dt.Rows(0)("OthersName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OthersPath").ToString) Then
                        obj.OthersPath = ""
                    Else
                        obj.OthersPath = dt.Rows(0)("OthersPath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetailVer").ToString) Then
                        obj.OtherDetailVer = ""
                    Else
                        obj.OtherDetailVer = dt.Rows(0)("OtherDetailVer").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetailVerComm").ToString) Then
                        obj.OtherDetailVerComm = ""
                    Else
                        obj.OtherDetailVerComm = dt.Rows(0)("OtherDetailVerComm").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignVerify").ToString) Then
                        obj.SignVerify = ""
                    Else
                        obj.SignVerify = dt.Rows(0)("SignVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignVerifyComm").ToString) Then
                        obj.SignVerifyComm = ""
                    Else
                        obj.SignVerifyComm = dt.Rows(0)("SignVerifyComm").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Remarks").ToString) Then
                        obj.Remarks = ""
                    Else
                        obj.Remarks = dt.Rows(0)("Remarks").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("gstname").ToString) Then
                        obj.gstname = ""
                    Else
                        obj.gstname = dt.Rows(0)("gstname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("gstpath").ToString) Then
                        obj.gstpath = ""
                    Else
                        obj.gstpath = dt.Rows(0)("gstpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("gpsourcecd").ToString) Then
                        obj.gpsourcecd = ""
                    Else
                        obj.gpsourcecd = dt.Rows(0)("gpsourcecd").ToString
                    End If

                    Return obj
                Else
                    Return Nothing
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Update_Data_GP_Details(ByVal o As ClsCRMContactForGPAndClient_All_New, ByVal mode As String) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim Com1, Com2 As SqlCommand
            Dim Ssql1, Ssql2 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            Com2 = New SqlCommand
            Com2.Connection = Con
            Com2.CommandType = CommandType.Text

            If o.Contactcd = "" Then
                Com1.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@date", o.Contactdate))
            Com1.Parameters.Add(New SqlParameter("@ltypecd", o.ltypecd))
            Com1.Parameters.Add(New SqlParameter("@title", o.title))
            Com1.Parameters.Add(New SqlParameter("@contactname", o.Contactname))
            Com1.Parameters.Add(New SqlParameter("@MiddleName", o.MiddleName))
            Com1.Parameters.Add(New SqlParameter("@LastName", o.LastName))
            Com1.Parameters.Add(New SqlParameter("@Gender", o.Gender))
            Com1.Parameters.Add(New SqlParameter("@companyname", o.CompanyName))
            If Trim(o.Segmentcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Segmentcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Segmentcd", o.Segmentcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@segother", o.segother))
            Com1.Parameters.Add(New SqlParameter("@dob", o.dob))
            Com1.Parameters.Add(New SqlParameter("@MaritalStatus", o.MaritalStatus))
            Com1.Parameters.Add(New SqlParameter("@SpouceName", o.SpouceName))
            Com1.Parameters.Add(New SqlParameter("@DOAnniversary", o.DOAnniversary))
            Com1.Parameters.Add(New SqlParameter("@Religion", o.Religion))
            Com1.Parameters.Add(New SqlParameter("@Nationality", o.Nationality))
            Com1.Parameters.Add(New SqlParameter("@QualificationStatus", o.QualificationStatus))
            If Trim(o.Sourcecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", System.DBNull.Value))
            End If
            If Trim(o.refbyContactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", System.DBNull.Value))
            End If
            If Trim(o.RefFreeText) = "" Then
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", o.RefFreeText))
            End If
            Com1.Parameters.Add(New SqlParameter("@mobile", o.Mobile))
            Com1.Parameters.Add(New SqlParameter("@mobile2", o.mobile2))
            Com1.Parameters.Add(New SqlParameter("@Office1", o.Office1))
            Com1.Parameters.Add(New SqlParameter("@Office2", o.Office2))
            Com1.Parameters.Add(New SqlParameter("@Home1", o.Home1))
            Com1.Parameters.Add(New SqlParameter("@Home2", o.Home2))
            Com1.Parameters.Add(New SqlParameter("@email", o.Email))
            Com1.Parameters.Add(New SqlParameter("@Email2", o.Email2))
            Com1.Parameters.Add(New SqlParameter("@Add1", o.Add1))
            Com1.Parameters.Add(New SqlParameter("@street", o.street))
            Com1.Parameters.Add(New SqlParameter("@Location", o.Location))
            Com1.Parameters.Add(New SqlParameter("@City", o.City))
            Com1.Parameters.Add(New SqlParameter("@State", o.State))
            Com1.Parameters.Add(New SqlParameter("@Country", o.Country))
            Com1.Parameters.Add(New SqlParameter("@Pincode", o.Pincode))
            Com1.Parameters.Add(New SqlParameter("@statuscd", o.statuscd))
            Com1.Parameters.Add(New SqlParameter("@bhcode", o.bhcode))
            If o.gpsourcecd = "" Then
                Com1.Parameters.Add(New SqlParameter("@gpsourcecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@gpsourcecd", o.gpsourcecd))
            End If
            If o.loccd = "" Then
                Com1.Parameters.Add(New SqlParameter("@loccd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@loccd", o.loccd))
            End If

            Com1.Parameters.Add(New SqlParameter("@crtuserid", o.crtuserid))
            Com1.Parameters.Add(New SqlParameter("@crtuserdt", o.crtuserdt))
            Com1.Parameters.Add(New SqlParameter("@moduserid", o.moduserid))
            Com1.Parameters.Add(New SqlParameter("@moduserdt", o.moduserdt))

            If UCase(mode.Trim) = "ADD" Then
                Com1.Parameters.Add(New SqlParameter("@Flag", "A"))
            Else
                Com1.Parameters.Add(New SqlParameter("@Flag", "E"))
            End If

            Ssql1 = "Sp_crmContacts_GP_AE_Detail"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            'Ssql2 = "update crmcontacts set allocated_uid='" & Trim(o.refbyContactcd) & "', allocatedBy_uid='" & Trim(o.crtuserid) & "' where contactcd ='" & Trim(o.Contactcd) & "' And ISNULL(allocated_uid,'') = '' "
            'Com2.CommandText = Ssql2
            'Com2.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                'If UCase(mode.Trim) = "ADD" Then
                If Trim(o.refbyContactcd) <> "" Then
                    'i = Com2.ExecuteNonQuery()
                End If
                'End If
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function

        '' Start GP Account
        Public Shared Function GetDocCodeForGPAccount(ByVal LeadType As String) As String
            Dim sSQL As String, objDas As New DBAccess, dt As DataTable
            'sSQL = "SELECT MAX(GPCode) AS ID FROM crmcontacts "
            'sSQL = "SELECT Count(GPCode) as ID FROM crmcontacts Where ltypecd = '" & Trim(LeadType) & "' "
            sSQL = "SELECT MAX(cast(Replace(GPCode,'GP','')as int)) AS ID FROM crmcontacts Where ltypecd = '" & Trim(LeadType) & "' "
            dt = objDas.GetDataTable(sSQL)
            If dt.Rows.Count > 0 Then
                If Not IsDBNull(dt.Rows(0).Item("ID")) Then
                    If dt.Rows(0).Item("ID").ToString <> "" Then
                        GetDocCodeForGPAccount = dt.Rows(0)("ID").ToString + 1
                    Else
                        GetDocCodeForGPAccount = 1
                    End If
                Else
                    GetDocCodeForGPAccount = 1
                End If
            End If
            Return GetDocCodeForGPAccount
        End Function

        Public Shared Function Generate_Docno_ForGP_Account(ByVal paramno As Integer)
            Try
                Dim docsrno As String
                docsrno = DocumentSrno(paramno, 1)
                Generate_Docno_ForGP_Account = Trim("GP") + "" + Trim(docsrno)
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Update_Data_GP_Account(ByVal o As ClsCRMContactForGPAndClient_All_New, ByVal mode As String) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim Com1, Com2 As SqlCommand
            Dim Ssql1, Ssql2 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            Com2 = New SqlCommand
            Com2.Connection = Con
            Com2.CommandType = CommandType.Text

            If o.Contactcd = "" Then
                Com1.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@date", o.Contactdate))
            Com1.Parameters.Add(New SqlParameter("@ltypecd", o.ltypecd))
            Com1.Parameters.Add(New SqlParameter("@title", o.title))
            Com1.Parameters.Add(New SqlParameter("@contactname", o.Contactname))
            Com1.Parameters.Add(New SqlParameter("@MiddleName", o.MiddleName))
            Com1.Parameters.Add(New SqlParameter("@LastName", o.LastName))
            Com1.Parameters.Add(New SqlParameter("@Gender", o.Gender))
            Com1.Parameters.Add(New SqlParameter("@companyname", o.CompanyName))
            If Trim(o.Segmentcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Segmentcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Segmentcd", o.Segmentcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@segother", o.segother))
            Com1.Parameters.Add(New SqlParameter("@dob", o.dob))
            Com1.Parameters.Add(New SqlParameter("@MaritalStatus", o.MaritalStatus))
            Com1.Parameters.Add(New SqlParameter("@SpouceName", o.SpouceName))
            Com1.Parameters.Add(New SqlParameter("@DOAnniversary", o.DOAnniversary))
            Com1.Parameters.Add(New SqlParameter("@Religion", o.Religion))
            Com1.Parameters.Add(New SqlParameter("@Nationality", o.Nationality))
            Com1.Parameters.Add(New SqlParameter("@QualificationStatus", o.QualificationStatus))
            If Trim(o.Sourcecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", o.Sourcecd))
            End If
            If Trim(o.refbyContactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", o.refbyContactcd))
            End If
            If Trim(o.RefFreeText) = "" Then
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", o.RefFreeText))
            End If
            If Trim(o.UserID) = "" Then
                Com1.Parameters.Add(New SqlParameter("@UserID", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@UserID", o.UserID))
            End If
            If Trim(o.Password) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Password", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Password", o.Password))
            End If
            Com1.Parameters.Add(New SqlParameter("@mobile", o.Mobile))
            Com1.Parameters.Add(New SqlParameter("@mobile2", o.mobile2))
            Com1.Parameters.Add(New SqlParameter("@Office1", o.Office1))
            Com1.Parameters.Add(New SqlParameter("@Office2", o.Office2))
            Com1.Parameters.Add(New SqlParameter("@Home1", o.Home1))
            Com1.Parameters.Add(New SqlParameter("@Home2", o.Home2))
            Com1.Parameters.Add(New SqlParameter("@email", o.Email))
            Com1.Parameters.Add(New SqlParameter("@Email2", o.Email2))
            Com1.Parameters.Add(New SqlParameter("@Add1", o.Add1))
            Com1.Parameters.Add(New SqlParameter("@street", o.street))
            Com1.Parameters.Add(New SqlParameter("@Location", o.Location))
            Com1.Parameters.Add(New SqlParameter("@City", o.City))
            Com1.Parameters.Add(New SqlParameter("@State", o.State))
            Com1.Parameters.Add(New SqlParameter("@Country", o.Country))
            Com1.Parameters.Add(New SqlParameter("@Pincode", o.Pincode))
            Com1.Parameters.Add(New SqlParameter("@statuscd", o.statuscd))

            '' GP Account
            Com1.Parameters.Add(New SqlParameter("@ApplicatinDate", o.ApplicatinDate))
            Com1.Parameters.Add(New SqlParameter("@GPCode", o.GPCode))
            Com1.Parameters.Add(New SqlParameter("@BankAccNo", o.BankAccNo))
            Com1.Parameters.Add(New SqlParameter("@BankAccType", o.BankAccType))
            Com1.Parameters.Add(New SqlParameter("@BankName", o.BankName))
            Com1.Parameters.Add(New SqlParameter("@Branch", o.Branch))
            Com1.Parameters.Add(New SqlParameter("@BankCity", o.BankCity))
            Com1.Parameters.Add(New SqlParameter("@IFSCCode", o.IFSCCode))
            Com1.Parameters.Add(New SqlParameter("@NomTitle", o.NomTitle))
            Com1.Parameters.Add(New SqlParameter("@NomFirstName", o.NomFirstName))
            Com1.Parameters.Add(New SqlParameter("@NomMiddleName", o.NomMiddleName))
            Com1.Parameters.Add(New SqlParameter("@NomLastName", o.NomLastName))
            Com1.Parameters.Add(New SqlParameter("@NomRelationship", o.NomRelationship))
            Com1.Parameters.Add(New SqlParameter("@NomDOB", o.NomDOB))
            Com1.Parameters.Add(New SqlParameter("@NomMobile", o.NomMobile))
            Com1.Parameters.Add(New SqlParameter("@NomHomePhoneNo", o.NomHomePhoneNo))
            Com1.Parameters.Add(New SqlParameter("@NomEmail", o.NomEmail))
            Com1.Parameters.Add(New SqlParameter("@NomAdd", o.NomAdd))
            Com1.Parameters.Add(New SqlParameter("@NomStreet", o.NomStreet))
            Com1.Parameters.Add(New SqlParameter("@NomLocation", o.NomLocation))
            Com1.Parameters.Add(New SqlParameter("@NomCity", o.NomCity))
            Com1.Parameters.Add(New SqlParameter("@NomState", o.NomState))
            Com1.Parameters.Add(New SqlParameter("@NomCountry", o.NomCountry))
            Com1.Parameters.Add(New SqlParameter("@NomPincode", o.NomPincode))
            Com1.Parameters.Add(New SqlParameter("@TrainedBy", o.TrainedBy))
            Com1.Parameters.Add(New SqlParameter("@TrainingDate", o.TrainingDate))
            Com1.Parameters.Add(New SqlParameter("@Score", o.Score))
            Com1.Parameters.Add(New SqlParameter("@CertifIssued", o.CertifIssued))
            Com1.Parameters.Add(New SqlParameter("@CertifDate", o.CertifDate))
            Com1.Parameters.Add(New SqlParameter("@CertifNo", o.CertifNo))
            Com1.Parameters.Add(New SqlParameter("@Appform", o.Appform))
            Com1.Parameters.Add(New SqlParameter("@panno", o.panno))
            Com1.Parameters.Add(New SqlParameter("@aadharno", o.aadharno))
            Com1.Parameters.Add(New SqlParameter("@passportno", o.passportno))
            Com1.Parameters.Add(New SqlParameter("@drvlicno", o.drvlicno))
            Com1.Parameters.Add(New SqlParameter("@GSTNNo", o.GSTNNo))
            Com1.Parameters.Add(New SqlParameter("@Others", o.Others))
            Com1.Parameters.Add(New SqlParameter("@OtherDetailVer", o.OtherDetailVer))
            Com1.Parameters.Add(New SqlParameter("@OtherDetailVerComm", o.OtherDetailVerComm))
            Com1.Parameters.Add(New SqlParameter("@SignVerify", o.SignVerify))
            Com1.Parameters.Add(New SqlParameter("@SignVerifyComm", o.SignVerifyComm))
            Com1.Parameters.Add(New SqlParameter("@Remarks", o.Remarks))
            Com1.Parameters.Add(New SqlParameter("@ReportingToFromBlueBand", ReportingToFromBlueBand))
            Com1.Parameters.Add(New SqlParameter("@gpsourcecd", o.gpsourcecd))

            Com1.Parameters.Add(New SqlParameter("@crtuserid", o.crtuserid))
            Com1.Parameters.Add(New SqlParameter("@crtuserdt", o.crtuserdt))
            Com1.Parameters.Add(New SqlParameter("@moduserid", o.moduserid))
            Com1.Parameters.Add(New SqlParameter("@moduserdt", o.moduserdt))

            If UCase(mode.Trim) = "ADD" Then
                Com1.Parameters.Add(New SqlParameter("@Flag", "A"))
            Else
                Com1.Parameters.Add(New SqlParameter("@Flag", "E"))
            End If

            Ssql1 = "Sp_crmContacts_GP_AE_Account"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            'Ssql2 = "update crmcontacts set allocated_uid='" & Trim(o.refbyContactcd) & "', allocatedBy_uid='" & Trim(o.crtuserid) & "' where contactcd ='" & Trim(o.Contactcd) & "' And ISNULL(allocated_uid,'') = '' "
            'Com2.CommandText = Ssql2
            'Com2.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                'If UCase(mode.Trim) = "ADD" Then
                If Trim(o.refbyContactcd) <> "" Then
                    'i = Com2.ExecuteNonQuery()
                End If
                'End If
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function

        '' Start GP Registration
        Public Shared Function GetDocCodeForGPReg(ByVal Product As String) As String
            Dim sSQL As String, objDas As New DBAccess, dt As DataTable
            'sSQL = "SELECT MAX(Srno) AS Srno FROM Register "
            sSQL = "SELECT Count(RegID) as ID FROM Register Where Productcd = '" & Trim(product) & "' "
            dt = objDas.GetDataTable(sSQL)
            If dt.Rows.Count > 0 Then
                If Not IsDBNull(dt.Rows(0).Item("ID")) Then
                    If dt.Rows(0).Item("ID").ToString <> "" Then
                        GetDocCodeForGPReg = dt.Rows(0)("ID").ToString + 1
                    Else
                        GetDocCodeForGPReg = 1
                    End If
                Else
                    GetDocCodeForGPReg = 1
                End If
            End If
            Return GetDocCodeForGPReg
        End Function

        'Public Shared Function Generate_Docno_ForGPReg(ByVal paramno As Integer, ByVal loccd As String)
        '    Try
        '        Dim startyr, endyr, doccode As String
        '        Dim ccode, LSN, PSN, docsrno As String

        '        Call DBAccess.Find_company()
        '        ccode = DBAccess.CmpCode
        '        Call DBAccess.Find_LocationShortName(loccd)
        '        LSN = DBAccess.LocationShortName
        '        'Call DBAccess.Find_ProductShortName(Productcd)
        '        'PSN = DBAccess.ProductShortName

        '        startyr = Right(Trim(DBAccess.FinStart), 2)
        '        endyr = Right(Trim(DBAccess.FinEnd), 2)
        '        docsrno = DocumentSrno(paramno, 1)

        '        Generate_Docno_ForGPReg = Trim(ccode) + "/" + Trim(LSN) + "/" + Trim(startyr) + "-" + Trim(endyr) + "/" + Trim("GP") + "/" + Trim(docsrno)
        '    Catch ex As Exception
        '        Throw ex
        '    End Try
        'End Function

        Public Shared Function Generate_Docno_ForGPReg(ByVal paramno As Integer, ByVal Product As String)
            Try
                Dim startyr, endyr, docsrno, ccode As String
                Call DBAccess.Find_company()
                ccode = DBAccess.CmpCode
                startyr = Right(Trim(DBAccess.FinStart), 2)
                endyr = Right(Trim(DBAccess.FinEnd), 2)
                docsrno = DocumentSrno(paramno, 1)
                'Generate_Docno_ForGPReg = Trim(loccd) + "/" + Trim(docsrno)
                Generate_Docno_ForGPReg = Trim(ccode) & Trim(startyr) & Trim(endyr) & "/" & Trim(Product) & "/" & Trim(docsrno)
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function DocumentSrno_ForGPReg(ByVal p As Integer, ByVal strlen As Integer) As String
            If strlen > Len(CStr(p)) Then
                DocumentSrno_ForGPReg = StrDup(strlen - Len(CStr(p)), "0") + CStr(p)
            Else
                DocumentSrno_ForGPReg = CStr(p)
            End If
        End Function

        Public Shared Function GetDataAllFor_GP_Register(ByVal contactcd As String, ByVal RegID As String, ByVal Flag As String) As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@contactcd", Contactcd))
                db.Parameters.Add(New SqlParameter("@RegID", RegID))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData_Register")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function FillData_GP_Registration(ByVal contactcd As String, ByVal RegID As String, ByVal Flag As String) As ClsCRMContactForGPAndClient_All_New
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@RegID", RegID))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData_Register")
                If dt.Rows.Count > 0 Then
                    Dim obj As ClsCRMContactForGPAndClient_All_New = New ClsCRMContactForGPAndClient_All_New
                    '' GP Registration Details
                    If Not IsDBNull(dt.Rows(0)("contactcd")) Then
                        obj.Contactcd = dt.Rows(0)("contactcd").ToString
                    End If
                    If Not IsDBNull(dt.Rows(0)("RegID")) Then
                        obj.RegID = dt.Rows(0)("RegID").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RegDate").ToString) Then
                        obj.RegDate = ""
                    Else
                        obj.RegDate = dt.Rows(0)("RegDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ProgramID").ToString) Then
                        obj.ProgramID = ""
                    Else
                        obj.ProgramID = dt.Rows(0)("ProgramID").ToString
                    End If
                    'If IsDBNull(dt.Rows(0)("BatchID").ToString) Then
                    '    obj.BatchID = ""
                    'Else
                    '    obj.BatchID = dt.Rows(0)("BatchID").ToString
                    'End If
                    If IsDBNull(dt.Rows(0)("ProgramDate").ToString) Then
                        obj.ProgramDate = ""
                    Else
                        obj.ProgramDate = dt.Rows(0)("ProgramDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ProgramTime").ToString) Then
                        obj.ProgramTime = ""
                    Else
                        obj.ProgramTime = dt.Rows(0)("ProgramTime").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("HR").ToString) Then
                        obj.HR = ""
                    Else
                        obj.HR = dt.Rows(0)("HR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Mi").ToString) Then
                        obj.Mi = ""
                    Else
                        obj.Mi = dt.Rows(0)("Mi").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AP").ToString) Then
                        obj.AP = ""
                    Else
                        obj.AP = dt.Rows(0)("AP").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("loccd").ToString) Then
                        obj.loccd = ""
                    Else
                        obj.loccd = dt.Rows(0)("loccd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("VenueCode").ToString) Then
                        obj.VenueCode = ""
                    Else
                        obj.VenueCode = dt.Rows(0)("VenueCode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TrainerCd").ToString) Then
                        obj.TrainerCd = ""
                    Else
                        obj.TrainerCd = dt.Rows(0)("TrainerCd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("PlanName").ToString) Then
                        obj.PlanName = ""
                    Else
                        obj.PlanName = dt.Rows(0)("PlanName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("productcd").ToString) Then
                        obj.productcd = ""
                    Else
                        obj.productcd = dt.Rows(0)("productcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GST").ToString) Then
                        obj.GST = ""
                    Else
                        obj.GST = dt.Rows(0)("GST").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TDSDeducted").ToString) Then
                        obj.TDSDeducted = ""
                    Else
                        obj.TDSDeducted = dt.Rows(0)("TDSDeducted").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmount").ToString) Then
                        obj.TotalAmount = 0
                    Else
                        obj.TotalAmount = dt.Rows(0)("TotalAmount").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmtAfterTDS").ToString) Then
                        obj.TotalAmtAfterTDS = 0
                    Else
                        obj.TotalAmtAfterTDS = dt.Rows(0)("TotalAmtAfterTDS").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmtInWords").ToString) Then
                        obj.TotalAmtInWords = ""
                    Else
                        obj.TotalAmtInWords = dt.Rows(0)("TotalAmtInWords").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TypeOfPayment").ToString) Then
                        obj.TypeOfPayment = ""
                    Else
                        obj.TypeOfPayment = dt.Rows(0)("TypeOfPayment").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("PaymentOtherDetails").ToString) Then
                        obj.PaymentOtherDetails = ""
                    Else
                        obj.PaymentOtherDetails = dt.Rows(0)("PaymentOtherDetails").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ModeOfPayment").ToString) Then
                        obj.ModeOfPayment = ""
                    Else
                        obj.ModeOfPayment = dt.Rows(0)("ModeOfPayment").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GrideTotalAmt").ToString) Then
                        obj.GrideTotalAmt = 0
                    Else
                        obj.GrideTotalAmt = dt.Rows(0)("GrideTotalAmt").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BalAmt").ToString) Then
                        obj.BalAmt = 0
                    Else
                        obj.BalAmt = dt.Rows(0)("BalAmt").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CallDate").ToString) Then
                        obj.CallDate = ""
                    Else
                        obj.CallDate = dt.Rows(0)("CallDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CallTime").ToString) Then
                        obj.CallTime = ""
                    Else
                        obj.CallTime = dt.Rows(0)("CallTime").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BHR").ToString) Then
                        obj.BHR = ""
                    Else
                        obj.BHR = dt.Rows(0)("BHR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BMi").ToString) Then
                        obj.BMi = ""
                    Else
                        obj.BMi = dt.Rows(0)("BMi").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BAP").ToString) Then
                        obj.BAP = ""
                    Else
                        obj.BAP = dt.Rows(0)("BAP").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("Comments").ToString) Then
                        obj.Comments = ""
                    Else
                        obj.Comments = dt.Rows(0)("Comments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetVerify").ToString) Then
                        obj.OtherDetVerify = ""
                    Else
                        obj.OtherDetVerify = dt.Rows(0)("OtherDetVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetComments").ToString) Then
                        obj.OtherDetComments = ""
                    Else
                        obj.OtherDetComments = dt.Rows(0)("OtherDetComments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignVerify").ToString) Then
                        obj.RSignVerify = ""
                    Else
                        obj.RSignVerify = dt.Rows(0)("SignVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignComments").ToString) Then
                        obj.RSignComments = ""
                    Else
                        obj.RSignComments = dt.Rows(0)("SignComments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RegType").ToString) Then
                        obj.RegType = ""
                    Else
                        obj.RegType = dt.Rows(0)("RegType").ToString
                    End If
                    '' End
                    Return obj
                Else
                    Return Nothing
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function GetDataForGride_GP_Register() As DataSet
            Dim dadet As New SqlDataAdapter
            Dim con As SqlConnection
            Dim comdet As SqlCommand
            Dim ds As DataSet

            con = GetConnection()
            comdet = GetCommand()
            ds = New DataSet

            comdet.Connection = con
            comdet.CommandType = CommandType.Text
            comdet.CommandText = "select * from RegisterDet where RegID='" & Trim(docno_RegID) & "' order by srno desc"
            dadet.SelectCommand = comdet

            Try
                dadet.Fill(ds, "RegisterDet")
            Catch ex As Exception
                Throw ex
            Finally
                con.Close()
                con = Nothing
                comdet = Nothing
                dadet = Nothing
            End Try
            Return ds
        End Function

        Public Shared Function Update_Data_GP_Registration(ByVal o As ClsCRMContactForGPAndClient_All_New, ByVal ds As DataSet, ByVal mode As String) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim dadet As New SqlDataAdapter
            Dim comdetold As SqlCommand
            Dim comdet As SqlCommand
            Dim cbdet As SqlCommandBuilder
            Dim Com1, Com2 As SqlCommand
            Dim Ssql1, Ssql2, Ssql3 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            comdet = New SqlCommand
            comdet.Connection = Con
            comdet.CommandType = CommandType.Text
            Ssql2 = "Select * From RegisterDet Where RegID='" & Trim(docno_RegID) & "'"
            comdet.CommandText = Ssql2
            comdet.Transaction = Trans

            comdetold = New SqlCommand
            comdetold.Connection = Con
            comdetold.CommandType = CommandType.Text
            Ssql3 = "Delete From RegisterDet Where RegID='" & Trim(docno_RegID) & "'"
            comdetold.CommandText = Ssql3
            comdetold.Transaction = Trans

            dadet.SelectCommand = comdet
            cbdet = New SqlCommandBuilder(dadet)

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            Com1.Parameters.Add(New SqlParameter("@Srno", o.Srno))
            Com1.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            Com1.Parameters.Add(New SqlParameter("@RegID", o.RegID))
            Com1.Parameters.Add(New SqlParameter("@RegDate", o.RegDate))
            Com1.Parameters.Add(New SqlParameter("@ProgramID", System.DBNull.Value))
            'Com1.Parameters.Add(New SqlParameter("@BatchID", o.BatchID))
            Com1.Parameters.Add(New SqlParameter("@ProgramDate", System.DBNull.Value))
            Com1.Parameters.Add(New SqlParameter("@ProgramTime", System.DBNull.Value))
            If Trim(o.loccd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@loccd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@loccd", o.loccd))
            End If
            If Trim(o.VenueCode) = "" Then
                Com1.Parameters.Add(New SqlParameter("@VenueCode", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@VenueCode", System.DBNull.Value))
            End If
            If Trim(o.TrainerCd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@TrainerCd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@TrainerCd", System.DBNull.Value))
            End If
            If Trim(o.PlanName) = "" Then
                Com1.Parameters.Add(New SqlParameter("@PlanName", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@PlanName", o.PlanName))
            End If
            If Trim(o.productcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@productcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@productcd", o.productcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@GST", System.DBNull.Value))
            Com1.Parameters.Add(New SqlParameter("@TDSDeducted", o.TDSDeducted))
            Com1.Parameters.Add(New SqlParameter("@TotalAmount", o.TotalAmount))
            Com1.Parameters.Add(New SqlParameter("@TotalAmtAfterTDS", o.TotalAmtAfterTDS))
            Com1.Parameters.Add(New SqlParameter("@TotalAmtInWords", o.TotalAmtInWords))
            Com1.Parameters.Add(New SqlParameter("@TypeOfPayment", o.TypeOfPayment))
            Com1.Parameters.Add(New SqlParameter("@ModeOfPayment", o.ModeOfPayment))
            Com1.Parameters.Add(New SqlParameter("@GrideTotalAmt", o.GrideTotalAmt))
            Com1.Parameters.Add(New SqlParameter("@BalAmt", o.BalAmt))
            If Trim(o.CallDate) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CallDate", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CallDate", o.CallDate))
            End If
            If Trim(o.CallTime) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CallTime", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CallTime", o.CallTime))
            End If
            Com1.Parameters.Add(New SqlParameter("@Comments", o.Comments))
            Com1.Parameters.Add(New SqlParameter("@OtherDetVerify", o.OtherDetVerify))
            Com1.Parameters.Add(New SqlParameter("@OtherDetComments", o.OtherDetComments))
            Com1.Parameters.Add(New SqlParameter("@SignVerify", o.RSignVerify))
            Com1.Parameters.Add(New SqlParameter("@SignComments", o.RSignComments))
            'Com1.Parameters.Add(New SqlParameter("@RegType", o.RegType))
            Com1.Parameters.Add(New SqlParameter("@bhcode", o.bhcode))
            Com1.Parameters.Add(New SqlParameter("@PaymentOtherDetails", o.PaymentOtherDetails))

            Com1.Parameters.Add(New SqlParameter("@crtuserid", o.crtuserid))
            Com1.Parameters.Add(New SqlParameter("@crtuserdt", o.crtuserdt))
            Com1.Parameters.Add(New SqlParameter("@moduserid", o.moduserid))
            Com1.Parameters.Add(New SqlParameter("@moduserdt", o.moduserdt))

            If UCase(mode.Trim) = "ADD" Then
                Com1.Parameters.Add(New SqlParameter("@Flag", "A"))
            Else
                Com1.Parameters.Add(New SqlParameter("@Flag", "E"))
            End If

            Ssql1 = "Sp_crmContacts_GP_AE_Register"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            'Ssql2 = "update crmcontacts set allocated_uid='" & Trim(o.refbyContactcd) & "', allocatedBy_uid='" & Trim(o.crtuserid) & "' where contactcd ='" & Trim(o.Contactcd) & "' And ISNULL(allocated_uid,'') = '' "
            'Com2.CommandText = Ssql2
            'Com2.Transaction = Trans

            Com2 = New SqlCommand
            Com2.Connection = Con
            Com2.CommandType = CommandType.StoredProcedure
            Com2.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            Com2.Parameters.Add(New SqlParameter("@RegID", o.RegID))
            Com2.Parameters.Add(New SqlParameter("@RegDate", o.RegDate))
            Ssql2 = "Sp_crmContacts_GP_UpdateStatus_Register"
            Com2.CommandText = Ssql2
            Com2.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                If UCase(mode.Trim) = "ADD" Then
                Else
                    comdetold.ExecuteNonQuery()
                End If
                i = dadet.Update(ds, "RegisterDet")
                i = Com2.ExecuteNonQuery()
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Com2 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function

        Public Shared Function GP_Reg_Delete(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            db.Parameters.Add(New SqlParameter("@RegID", o.RegID))
            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Delete_Register")
            Return retval
        End Function
        '' End GP

        '' Start Client Details
        Public Shared Function FillData_Client(ByVal contactcd As String, ByVal ltypecd As String, ByVal areacd As String, ByVal Flag As String, ByVal UserID As String) As ClsCRMContactForGPAndClient_All_New
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@Statuscd", ""))
                db.Parameters.Add(New SqlParameter("@open", ""))
                db.Parameters.Add(New SqlParameter("@empcd", ""))
                db.Parameters.Add(New SqlParameter("@ActionDate", ""))
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@ltypecd", ltypecd))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))
                db.Parameters.Add(New SqlParameter("@crtuserid", UserID))
                db.Parameters.Add(New SqlParameter("@loccd", ""))
                db.Parameters.Add(New SqlParameter("@leadindcd", ""))
                db.Parameters.Add(New SqlParameter("@SubIndustryCode", ""))
                db.Parameters.Add(New SqlParameter("@fromdt", ""))
                db.Parameters.Add(New SqlParameter("@todt", ""))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GP_GetData")
                If dt.Rows.Count > 0 Then
                    Dim obj As ClsCRMContactForGPAndClient_All_New = New ClsCRMContactForGPAndClient_All_New
                    If Not IsDBNull(dt.Rows(0)("contactcd")) Then
                        obj.Contactcd = dt.Rows(0)("contactcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("date").ToString) Then
                        obj.Contactdate = ""
                    Else
                        obj.Contactdate = dt.Rows(0)("date").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ltypecd").ToString) Then
                        obj.ltypecd = ""
                    Else
                        obj.ltypecd = dt.Rows(0)("ltypecd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("title").ToString) Then
                        obj.title = ""
                    Else
                        obj.title = dt.Rows(0)("title").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("contactname").ToString) Then
                        obj.Contactname = ""
                    Else
                        obj.Contactname = dt.Rows(0)("contactname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("MiddleName").ToString) Then
                        obj.MiddleName = ""
                    Else
                        obj.MiddleName = dt.Rows(0)("MiddleName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("LastName").ToString) Then
                        obj.LastName = ""
                    Else
                        obj.LastName = dt.Rows(0)("LastName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Gender").ToString) Then
                        obj.Gender = ""
                    Else
                        obj.Gender = dt.Rows(0)("Gender").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Designation").ToString) Then
                        obj.Designation = ""
                    Else
                        obj.Designation = dt.Rows(0)("Designation").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("QualificationStatus").ToString) Then
                        obj.QualificationStatus = ""
                    Else
                        obj.QualificationStatus = dt.Rows(0)("QualificationStatus").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("dob").ToString) Then
                        obj.dob = ""
                    Else
                        obj.dob = dt.Rows(0)("dob").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("MaritalStatus").ToString) Then
                        obj.MaritalStatus = ""
                    Else
                        obj.MaritalStatus = dt.Rows(0)("MaritalStatus").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SpouceName").ToString) Then
                        obj.SpouceName = ""
                    Else
                        obj.SpouceName = dt.Rows(0)("SpouceName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("DOAnniversary").ToString) Then
                        obj.DOAnniversary = ""
                    Else
                        obj.DOAnniversary = dt.Rows(0)("DOAnniversary").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Religion").ToString) Then
                        obj.Religion = ""
                    Else
                        obj.Religion = dt.Rows(0)("Religion").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Nationality").ToString) Then
                        obj.Nationality = ""
                    Else
                        obj.Nationality = dt.Rows(0)("Nationality").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("productcd").ToString) Then
                        obj.productcd = ""
                    Else
                        obj.productcd = dt.Rows(0)("productcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("MartialStatus").ToString) Then
                        obj.MartialStatus = ""
                    Else
                        obj.MartialStatus = dt.Rows(0)("MartialStatus").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Sourcecd").ToString) Then
                        obj.Sourcecd = ""
                    Else
                        obj.Sourcecd = dt.Rows(0)("Sourcecd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("refbyContactcd").ToString) Then
                        obj.refbyContactcd = ""
                    Else
                        obj.refbyContactcd = dt.Rows(0)("refbyContactcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RefFreeText").ToString) Then
                        obj.RefFreeText = ""
                    Else
                        obj.RefFreeText = dt.Rows(0)("RefFreeText").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("UserID").ToString) Then
                        obj.UserID = ""
                    Else
                        obj.UserID = dt.Rows(0)("UserID").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Password").ToString) Then
                        obj.Password = ""
                    Else
                        obj.Password = dt.Rows(0)("Password").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("mobile").ToString) Then
                        obj.Mobile = ""
                    Else
                        obj.Mobile = dt.Rows(0)("mobile").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("mobile2").ToString) Then
                        obj.mobile2 = ""
                    Else
                        obj.mobile2 = dt.Rows(0)("mobile2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Office1").ToString) Then
                        obj.Office1 = ""
                    Else
                        obj.Office1 = dt.Rows(0)("Office1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Office2").ToString) Then
                        obj.Office2 = ""
                    Else
                        obj.Office2 = dt.Rows(0)("Office2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Home1").ToString) Then
                        obj.Home1 = ""
                    Else
                        obj.Home1 = dt.Rows(0)("Home1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Home2").ToString) Then
                        obj.Home2 = ""
                    Else
                        obj.Home2 = dt.Rows(0)("Home2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("email").ToString) Then
                        obj.Email = ""
                    Else
                        obj.Email = dt.Rows(0)("email").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Email2").ToString) Then
                        obj.Email2 = ""
                    Else
                        obj.Email2 = dt.Rows(0)("Email2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("companyname").ToString) Then
                        obj.CompanyName = ""
                    Else
                        obj.CompanyName = dt.Rows(0)("companyname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("leadindcd").ToString) Then
                        obj.leadindcd = ""
                    Else
                        obj.leadindcd = dt.Rows(0)("leadindcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("crmIndustryTypecd").ToString) Then
                        obj.crmIndustryTypecd = ""
                    Else
                        obj.crmIndustryTypecd = dt.Rows(0)("crmIndustryTypecd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("YearofEst").ToString) Then
                        obj.YearofEst = ""
                    Else
                        obj.YearofEst = dt.Rows(0)("YearofEst").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AnnualTurnover").ToString) Then
                        obj.AnnualTurnover = ""
                    Else
                        obj.AnnualTurnover = dt.Rows(0)("AnnualTurnover").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NoofEmployeescd").ToString) Then
                        obj.NoofEmployeescd = ""
                    Else
                        obj.NoofEmployeescd = dt.Rows(0)("NoofEmployeescd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("qulificationcd").ToString) Then
                        obj.qulificationcd = ""
                    Else
                        obj.qulificationcd = dt.Rows(0)("qulificationcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TypeOfEntity").ToString) Then
                        obj.TypeOfEntity = ""
                    Else
                        obj.TypeOfEntity = dt.Rows(0)("TypeOfEntity").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BIProduct").ToString) Then
                        obj.BIProduct = ""
                    Else
                        obj.BIProduct = dt.Rows(0)("BIProduct").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Add1").ToString) Then
                        obj.Add1 = ""
                    Else
                        obj.Add1 = dt.Rows(0)("Add1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("street").ToString) Then
                        obj.street = ""
                    Else
                        obj.street = dt.Rows(0)("street").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Location").ToString) Then
                        obj.Location = ""
                    Else
                        obj.Location = dt.Rows(0)("Location").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("City").ToString) Then
                        obj.City = ""
                    Else
                        obj.City = dt.Rows(0)("City").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("State").ToString) Then
                        obj.State = ""
                    Else
                        obj.State = dt.Rows(0)("State").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Country").ToString) Then
                        obj.Country = ""
                    Else
                        obj.Country = dt.Rows(0)("Country").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Pincode").ToString) Then
                        obj.Pincode = ""
                    Else
                        obj.Pincode = dt.Rows(0)("Pincode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SubIndustryCode").ToString) Then
                        obj.SubIndustryCode = ""
                    Else
                        obj.SubIndustryCode = dt.Rows(0)("SubIndustryCode").ToString
                    End If

                    '' Client Account
                    If IsDBNull(dt.Rows(0)("ApplicatinDate").ToString) Then
                        obj.ApplicatinDate = ""
                    Else
                        obj.ApplicatinDate = dt.Rows(0)("ApplicatinDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GPCode").ToString) Then
                        obj.GPCode = ""
                    Else
                        obj.GPCode = dt.Rows(0)("GPCode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Photo").ToString) Then
                        obj.Photo = ""
                    Else
                        obj.Photo = dt.Rows(0)("Photo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Photopath").ToString) Then
                        obj.Photopath = ""
                    Else
                        obj.Photopath = dt.Rows(0)("Photopath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankAccNo").ToString) Then
                        obj.BankAccNo = ""
                    Else
                        obj.BankAccNo = dt.Rows(0)("BankAccNo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankAccType").ToString) Then
                        obj.BankAccType = ""
                    Else
                        obj.BankAccType = dt.Rows(0)("BankAccType").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankName").ToString) Then
                        obj.BankName = ""
                    Else
                        obj.BankName = dt.Rows(0)("BankName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Branch").ToString) Then
                        obj.Branch = ""
                    Else
                        obj.Branch = dt.Rows(0)("Branch").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BankCity").ToString) Then
                        obj.BankCity = ""
                    Else
                        obj.BankCity = dt.Rows(0)("BankCity").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("IFSCCode").ToString) Then
                        obj.IFSCCode = ""
                    Else
                        obj.IFSCCode = dt.Rows(0)("IFSCCode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomTitle").ToString) Then
                        obj.NomTitle = ""
                    Else
                        obj.NomTitle = dt.Rows(0)("NomTitle").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomFirstName").ToString) Then
                        obj.NomFirstName = ""
                    Else
                        obj.NomFirstName = dt.Rows(0)("NomFirstName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomMiddleName").ToString) Then
                        obj.NomMiddleName = ""
                    Else
                        obj.NomMiddleName = dt.Rows(0)("NomMiddleName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomLastName").ToString) Then
                        obj.NomLastName = ""
                    Else
                        obj.NomLastName = dt.Rows(0)("NomLastName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomRelationship").ToString) Then
                        obj.NomRelationship = ""
                    Else
                        obj.NomRelationship = dt.Rows(0)("NomRelationship").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomDOB").ToString) Then
                        obj.NomDOB = ""
                    Else
                        obj.NomDOB = dt.Rows(0)("NomDOB").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomMobile").ToString) Then
                        obj.NomMobile = ""
                    Else
                        obj.NomMobile = dt.Rows(0)("NomMobile").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomHomePhoneNo").ToString) Then
                        obj.NomHomePhoneNo = ""
                    Else
                        obj.NomHomePhoneNo = dt.Rows(0)("NomHomePhoneNo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomEmail").ToString) Then
                        obj.NomEmail = ""
                    Else
                        obj.NomEmail = dt.Rows(0)("NomEmail").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomAdd").ToString) Then
                        obj.NomAdd = ""
                    Else
                        obj.NomAdd = dt.Rows(0)("NomAdd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomStreet").ToString) Then
                        obj.NomStreet = ""
                    Else
                        obj.NomStreet = dt.Rows(0)("NomStreet").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomLocation").ToString) Then
                        obj.NomLocation = ""
                    Else
                        obj.NomLocation = dt.Rows(0)("NomLocation").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomCity").ToString) Then
                        obj.NomCity = ""
                    Else
                        obj.NomCity = dt.Rows(0)("NomCity").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomState").ToString) Then
                        obj.NomState = ""
                    Else
                        obj.NomState = dt.Rows(0)("NomState").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomCountry").ToString) Then
                        obj.NomCountry = ""
                    Else
                        obj.NomCountry = dt.Rows(0)("NomCountry").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("NomPincode").ToString) Then
                        obj.NomPincode = ""
                    Else
                        obj.NomPincode = dt.Rows(0)("NomPincode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Appform").ToString) Then
                        obj.Appform = ""
                    Else
                        obj.Appform = dt.Rows(0)("Appform").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AppformName").ToString) Then
                        obj.AppformName = ""
                    Else
                        obj.AppformName = dt.Rows(0)("AppformName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AppformPath").ToString) Then
                        obj.AppformPath = ""
                    Else
                        obj.AppformPath = dt.Rows(0)("AppformPath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("panno").ToString) Then
                        obj.panno = ""
                    Else
                        obj.panno = dt.Rows(0)("panno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("panname").ToString) Then
                        obj.panname = ""
                    Else
                        obj.panname = dt.Rows(0)("panname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("panpath").ToString) Then
                        obj.panpath = ""
                    Else
                        obj.panpath = dt.Rows(0)("panpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("aadharno").ToString) Then
                        obj.aadharno = ""
                    Else
                        obj.aadharno = dt.Rows(0)("aadharno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("aadharname").ToString) Then
                        obj.aadharname = ""
                    Else
                        obj.aadharname = dt.Rows(0)("aadharname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("aadharpath").ToString) Then
                        obj.aadharpath = ""
                    Else
                        obj.aadharpath = dt.Rows(0)("aadharpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("passportno").ToString) Then
                        obj.passportno = ""
                    Else
                        obj.passportno = dt.Rows(0)("passportno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("passportname").ToString) Then
                        obj.passportname = ""
                    Else
                        obj.passportname = dt.Rows(0)("passportname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("passportpath").ToString) Then
                        obj.passportpath = ""
                    Else
                        obj.passportpath = dt.Rows(0)("passportpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("drvlicno").ToString) Then
                        obj.drvlicno = ""
                    Else
                        obj.drvlicno = dt.Rows(0)("drvlicno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("drvlicname").ToString) Then
                        obj.drvlicname = ""
                    Else
                        obj.drvlicname = dt.Rows(0)("drvlicname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("drvlicpath").ToString) Then
                        obj.drvlicpath = ""
                    Else
                        obj.drvlicpath = dt.Rows(0)("drvlicpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GSTNNo").ToString) Then
                        obj.GSTNNo = ""
                    Else
                        obj.GSTNNo = dt.Rows(0)("GSTNNo").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Others").ToString) Then
                        obj.Others = ""
                    Else
                        obj.Others = dt.Rows(0)("Others").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OthersName").ToString) Then
                        obj.OthersName = ""
                    Else
                        obj.OthersName = dt.Rows(0)("OthersName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OthersPath").ToString) Then
                        obj.OthersPath = ""
                    Else
                        obj.OthersPath = dt.Rows(0)("OthersPath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetailVer").ToString) Then
                        obj.OtherDetailVer = ""
                    Else
                        obj.OtherDetailVer = dt.Rows(0)("OtherDetailVer").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetailVerComm").ToString) Then
                        obj.OtherDetailVerComm = ""
                    Else
                        obj.OtherDetailVerComm = dt.Rows(0)("OtherDetailVerComm").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignVerify").ToString) Then
                        obj.SignVerify = ""
                    Else
                        obj.SignVerify = dt.Rows(0)("SignVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignVerifyComm").ToString) Then
                        obj.SignVerifyComm = ""
                    Else
                        obj.SignVerifyComm = dt.Rows(0)("SignVerifyComm").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Remarks").ToString) Then
                        obj.Remarks = ""
                    Else
                        obj.Remarks = dt.Rows(0)("Remarks").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("gstname").ToString) Then
                        obj.gstname = ""
                    Else
                        obj.gstname = dt.Rows(0)("gstname").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("gstpath").ToString) Then
                        obj.gstpath = ""
                    Else
                        obj.gstpath = dt.Rows(0)("gstpath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("PerBuss").ToString) Then
                        obj.PerBuss = 0
                    Else
                        obj.PerBuss = dt.Rows(0)("PerBuss").ToString
                    End If
                    Return obj
                Else
                    Return Nothing
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Update_Data_Client_Details(ByVal o As ClsCRMContactForGPAndClient_All_New, ByVal mode As String) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim Com1, Com2 As SqlCommand
            Dim Ssql1, Ssql2 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            Com2 = New SqlCommand
            Com2.Connection = Con
            Com2.CommandType = CommandType.Text

            If o.Contactcd = "" Then
                Com1.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@date", o.Contactdate))
            Com1.Parameters.Add(New SqlParameter("@ltypecd", o.ltypecd))
            Com1.Parameters.Add(New SqlParameter("@title", o.title))
            Com1.Parameters.Add(New SqlParameter("@contactname", o.Contactname))
            Com1.Parameters.Add(New SqlParameter("@MiddleName", o.MiddleName))
            Com1.Parameters.Add(New SqlParameter("@LastName", o.LastName))
            Com1.Parameters.Add(New SqlParameter("@Gender", o.Gender))
            Com1.Parameters.Add(New SqlParameter("@Designation", o.Designation))
            Com1.Parameters.Add(New SqlParameter("@QualificationStatus", o.QualificationStatus))
            Com1.Parameters.Add(New SqlParameter("@dob", o.dob))
            Com1.Parameters.Add(New SqlParameter("@MaritalStatus", o.MaritalStatus))
            Com1.Parameters.Add(New SqlParameter("@SpouceName", o.SpouceName))
            Com1.Parameters.Add(New SqlParameter("@DOAnniversary", o.DOAnniversary))
            Com1.Parameters.Add(New SqlParameter("@Religion", o.Religion))
            Com1.Parameters.Add(New SqlParameter("@Nationality", o.Nationality))
            If Trim(o.productcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@productcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@productcd", o.productcd))
            End If
            If Trim(o.Sourcecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", o.Sourcecd))
            End If
            If Trim(o.refbyContactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", o.refbyContactcd))
            End If
            If Trim(o.RefFreeText) = "" Then
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", o.RefFreeText))
            End If
            Com1.Parameters.Add(New SqlParameter("@mobile", o.Mobile))
            Com1.Parameters.Add(New SqlParameter("@mobile2", o.mobile2))
            Com1.Parameters.Add(New SqlParameter("@Office1", o.Office1))
            Com1.Parameters.Add(New SqlParameter("@Office2", o.Office2))
            Com1.Parameters.Add(New SqlParameter("@Home1", o.Home1))
            Com1.Parameters.Add(New SqlParameter("@Home2", o.Home2))
            Com1.Parameters.Add(New SqlParameter("@email", o.Email))
            Com1.Parameters.Add(New SqlParameter("@Email2", o.Email2))
            Com1.Parameters.Add(New SqlParameter("@companyname", o.CompanyName))
            If Trim(o.leadindcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@leadindcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@leadindcd", o.leadindcd))
            End If
            If Trim(o.crmIndustryTypecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@crmIndustryTypecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@crmIndustryTypecd", o.crmIndustryTypecd))
            End If
            Com1.Parameters.Add(New SqlParameter("@YearofEst", o.YearofEst))
            Com1.Parameters.Add(New SqlParameter("@AnnualTurnover", o.AnnualTurnover))
            If Trim(o.NoofEmployeescd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@NoofEmployeescd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@NoofEmployeescd", o.NoofEmployeescd))
            End If
            If Trim(o.qulificationcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@qulificationcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@qulificationcd", o.qulificationcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@TypeOfEntity", o.TypeOfEntity))
            Com1.Parameters.Add(New SqlParameter("@BIProduct", o.BIProduct))
            Com1.Parameters.Add(New SqlParameter("@Add1", o.Add1))
            Com1.Parameters.Add(New SqlParameter("@street", o.street))
            Com1.Parameters.Add(New SqlParameter("@Location", o.Location))
            Com1.Parameters.Add(New SqlParameter("@City", o.City))
            Com1.Parameters.Add(New SqlParameter("@State", o.State))
            Com1.Parameters.Add(New SqlParameter("@Country", o.Country))
            Com1.Parameters.Add(New SqlParameter("@Pincode", o.Pincode))
            Com1.Parameters.Add(New SqlParameter("@statuscd", o.statuscd))
            Com1.Parameters.Add(New SqlParameter("@bhcode", o.bhcode))
            Com1.Parameters.Add(New SqlParameter("@SubIndustryCode", o.SubIndustryCode))
            If o.loccd = "" Then
                Com1.Parameters.Add(New SqlParameter("@loccd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@loccd", o.loccd))
            End If
            '' Client Account

            ''
            Com1.Parameters.Add(New SqlParameter("@crtuserid", o.crtuserid))
            Com1.Parameters.Add(New SqlParameter("@crtuserdt", o.crtuserdt))
            Com1.Parameters.Add(New SqlParameter("@moduserid", o.moduserid))
            Com1.Parameters.Add(New SqlParameter("@moduserdt", o.moduserdt))

            If UCase(mode.Trim) = "ADD" Then
                Com1.Parameters.Add(New SqlParameter("@Flag", "A"))
            Else
                Com1.Parameters.Add(New SqlParameter("@Flag", "E"))
            End If

            Ssql1 = "Sp_crmContacts_Client_AE_Detail"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            'Ssql2 = "update crmcontacts set allocated_uid='" & Trim(o.refbyContactcd) & "', allocatedBy_uid='" & Trim(o.crtuserid) & "' where contactcd ='" & Trim(o.Contactcd) & "' And ISNULL(allocated_uid,'') = '' "
            'Com2.CommandText = Ssql2
            'Com2.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                'If UCase(mode.Trim) = "ADD" Then
                If Trim(o.refbyContactcd) <> "" Then
                    'i = Com2.ExecuteNonQuery()
                End If
                'End If
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function

        '' Start Client Account
        Public Shared Function GetDocCodeForClientAccount(ByVal LeadType As String) As String
            Dim sSQL As String, objDas As New DBAccess, dt As DataTable
            'sSQL = "SELECT MAX(GPCode) AS ID FROM crmcontacts "
            'sSQL = "SELECT Count(GPCode) as ID FROM crmcontacts Where ltypecd = '" & Trim(LeadType) & "' "
            sSQL = "SELECT MAX(cast(Replace(GPCode,'CL','')as int)) AS ID FROM crmcontacts Where ltypecd = '" & Trim(LeadType) & "' "

            dt = objDas.GetDataTable(sSQL)
            If dt.Rows.Count > 0 Then
                If Not IsDBNull(dt.Rows(0).Item("ID")) Then
                    If dt.Rows(0).Item("ID").ToString <> "" Then
                        GetDocCodeForClientAccount = dt.Rows(0)("ID").ToString + 1
                    Else
                        GetDocCodeForClientAccount = 1
                    End If
                Else
                    GetDocCodeForClientAccount = 1
                End If
            End If
            Return GetDocCodeForClientAccount
        End Function

        Public Shared Function Generate_Docno_ForClient_Account(ByVal paramno As Integer)
            Try
                Dim docsrno As String
                docsrno = DocumentSrno(paramno, 1)
                Generate_Docno_ForClient_Account = Trim("CL") + "" + Trim(docsrno)
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Update_Data_Client_Account(ByVal o As ClsCRMContactForGPAndClient_All_New, ByVal mode As String) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim Com1, Com2 As SqlCommand
            Dim Ssql1, Ssql2 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            Com2 = New SqlCommand
            Com2.Connection = Con
            Com2.CommandType = CommandType.Text

            If o.Contactcd = "" Then
                Com1.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@date", o.Contactdate))
            Com1.Parameters.Add(New SqlParameter("@ltypecd", o.ltypecd))
            Com1.Parameters.Add(New SqlParameter("@title", o.title))
            Com1.Parameters.Add(New SqlParameter("@contactname", o.Contactname))
            Com1.Parameters.Add(New SqlParameter("@MiddleName", o.MiddleName))
            Com1.Parameters.Add(New SqlParameter("@LastName", o.LastName))
            Com1.Parameters.Add(New SqlParameter("@Gender", o.Gender))
            Com1.Parameters.Add(New SqlParameter("@Designation", o.Designation))
            Com1.Parameters.Add(New SqlParameter("@QualificationStatus", o.QualificationStatus))
            Com1.Parameters.Add(New SqlParameter("@dob", o.dob))
            If Trim(o.MartialStatus) = "" Then
                Com1.Parameters.Add(New SqlParameter("@MartialStatus", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@MartialStatus", o.MartialStatus))
            End If
            Com1.Parameters.Add(New SqlParameter("@SpouceName", o.SpouceName))
            Com1.Parameters.Add(New SqlParameter("@DOAnniversary", o.DOAnniversary))
            Com1.Parameters.Add(New SqlParameter("@Religion", o.Religion))
            Com1.Parameters.Add(New SqlParameter("@Nationality", o.Nationality))
            If Trim(o.productcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@productcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@productcd", o.productcd))
            End If
            If Trim(o.Sourcecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", o.Sourcecd))
            End If
            If Trim(o.refbyContactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", o.refbyContactcd))
            End If
            If Trim(o.RefFreeText) = "" Then
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@RefFreeText", o.RefFreeText))
            End If
            If Trim(o.UserID) = "" Then
                Com1.Parameters.Add(New SqlParameter("@UserID", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@UserID", o.UserID))
            End If
            If Trim(o.Password) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Password", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Password", o.Password))
            End If
            Com1.Parameters.Add(New SqlParameter("@mobile", o.Mobile))
            Com1.Parameters.Add(New SqlParameter("@mobile2", o.mobile2))
            Com1.Parameters.Add(New SqlParameter("@Office1", o.Office1))
            Com1.Parameters.Add(New SqlParameter("@Office2", o.Office2))
            Com1.Parameters.Add(New SqlParameter("@Home1", o.Home1))
            Com1.Parameters.Add(New SqlParameter("@Home2", o.Home2))
            Com1.Parameters.Add(New SqlParameter("@email", o.Email))
            Com1.Parameters.Add(New SqlParameter("@Email2", o.Email2))
            Com1.Parameters.Add(New SqlParameter("@companyname", o.CompanyName))
            If Trim(o.leadindcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@leadindcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@leadindcd", o.leadindcd))
            End If
            If Trim(o.crmIndustryTypecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@crmIndustryTypecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@crmIndustryTypecd", o.crmIndustryTypecd))
            End If
            Com1.Parameters.Add(New SqlParameter("@YearofEst", o.YearofEst))
            Com1.Parameters.Add(New SqlParameter("@AnnualTurnover", o.AnnualTurnover))
            If Trim(o.NoofEmployeescd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@NoofEmployeescd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@NoofEmployeescd", o.NoofEmployeescd))
            End If
            If Trim(o.qulificationcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@qulificationcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@qulificationcd", o.qulificationcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@TypeOfEntity", o.TypeOfEntity))
            Com1.Parameters.Add(New SqlParameter("@BIProduct", o.BIProduct))
            Com1.Parameters.Add(New SqlParameter("@Add1", o.Add1))
            Com1.Parameters.Add(New SqlParameter("@street", o.street))
            Com1.Parameters.Add(New SqlParameter("@Location", o.Location))
            Com1.Parameters.Add(New SqlParameter("@City", o.City))
            Com1.Parameters.Add(New SqlParameter("@State", o.State))
            Com1.Parameters.Add(New SqlParameter("@Country", o.Country))
            Com1.Parameters.Add(New SqlParameter("@Pincode", o.Pincode))
            Com1.Parameters.Add(New SqlParameter("@statuscd", o.statuscd))
            Com1.Parameters.Add(New SqlParameter("@SubIndustryCode", o.SubIndustryCode))

            '' Client Account
            Com1.Parameters.Add(New SqlParameter("@ApplicatinDate", o.ApplicatinDate))
            Com1.Parameters.Add(New SqlParameter("@GPCode", o.GPCode))
            Com1.Parameters.Add(New SqlParameter("@BankAccNo", o.BankAccNo))
            Com1.Parameters.Add(New SqlParameter("@BankAccType", o.BankAccType))
            Com1.Parameters.Add(New SqlParameter("@BankName", o.BankName))
            Com1.Parameters.Add(New SqlParameter("@Branch", o.Branch))
            Com1.Parameters.Add(New SqlParameter("@BankCity", o.BankCity))
            Com1.Parameters.Add(New SqlParameter("@IFSCCode", o.IFSCCode))
            Com1.Parameters.Add(New SqlParameter("@NomTitle", o.NomTitle))
            Com1.Parameters.Add(New SqlParameter("@NomFirstName", o.NomFirstName))
            Com1.Parameters.Add(New SqlParameter("@NomMiddleName", o.NomMiddleName))
            Com1.Parameters.Add(New SqlParameter("@NomLastName", o.NomLastName))
            Com1.Parameters.Add(New SqlParameter("@NomRelationship", o.NomRelationship))
            Com1.Parameters.Add(New SqlParameter("@NomDOB", o.NomDOB))
            Com1.Parameters.Add(New SqlParameter("@NomMobile", o.NomMobile))
            Com1.Parameters.Add(New SqlParameter("@NomHomePhoneNo", o.NomHomePhoneNo))
            Com1.Parameters.Add(New SqlParameter("@NomEmail", o.NomEmail))
            Com1.Parameters.Add(New SqlParameter("@NomAdd", o.NomAdd))
            Com1.Parameters.Add(New SqlParameter("@NomStreet", o.NomStreet))
            Com1.Parameters.Add(New SqlParameter("@NomLocation", o.NomLocation))
            Com1.Parameters.Add(New SqlParameter("@NomCity", o.NomCity))
            Com1.Parameters.Add(New SqlParameter("@NomState", o.NomState))
            Com1.Parameters.Add(New SqlParameter("@NomCountry", o.NomCountry))
            Com1.Parameters.Add(New SqlParameter("@NomPincode", o.NomPincode))
            Com1.Parameters.Add(New SqlParameter("@Appform", o.Appform))
            Com1.Parameters.Add(New SqlParameter("@panno", o.panno))
            Com1.Parameters.Add(New SqlParameter("@aadharno", o.aadharno))
            Com1.Parameters.Add(New SqlParameter("@passportno", o.passportno))
            Com1.Parameters.Add(New SqlParameter("@drvlicno", o.drvlicno))
            Com1.Parameters.Add(New SqlParameter("@GSTNNo", o.GSTNNo))
            Com1.Parameters.Add(New SqlParameter("@Others", o.Others))
            Com1.Parameters.Add(New SqlParameter("@OtherDetailVer", o.OtherDetailVer))
            Com1.Parameters.Add(New SqlParameter("@OtherDetailVerComm", o.OtherDetailVerComm))
            Com1.Parameters.Add(New SqlParameter("@SignVerify", o.SignVerify))
            Com1.Parameters.Add(New SqlParameter("@SignVerifyComm", o.SignVerifyComm))
            Com1.Parameters.Add(New SqlParameter("@Remarks", o.Remarks))
            Com1.Parameters.Add(New SqlParameter("@ReportingToFromBlueBand", ReportingToFromBlueBand))
            Com1.Parameters.Add(New SqlParameter("@PerBuss", o.PerBuss))
            ''
            Com1.Parameters.Add(New SqlParameter("@crtuserid", o.crtuserid))
            Com1.Parameters.Add(New SqlParameter("@crtuserdt", o.crtuserdt))
            Com1.Parameters.Add(New SqlParameter("@moduserid", o.moduserid))
            Com1.Parameters.Add(New SqlParameter("@moduserdt", o.moduserdt))

            If UCase(mode.Trim) = "ADD" Then
                Com1.Parameters.Add(New SqlParameter("@Flag", "A"))
            Else
                Com1.Parameters.Add(New SqlParameter("@Flag", "E"))
            End If

            Ssql1 = "Sp_crmContacts_Client_AE_Account"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            'Ssql2 = "update crmcontacts set allocated_uid='" & Trim(o.refbyContactcd) & "', allocatedBy_uid='" & Trim(o.crtuserid) & "' where contactcd ='" & Trim(o.Contactcd) & "' And ISNULL(allocated_uid,'') = '' "
            'Com2.CommandText = Ssql2
            'Com2.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                'If UCase(mode.Trim) = "ADD" Then
                If Trim(o.refbyContactcd) <> "" Then
                    'i = Com2.ExecuteNonQuery()
                End If
                'End If
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function

        '' Start Client Registration
        Public Shared Function GetDocCodeForClientReg(ByVal Product As String) As String
            Dim sSQL As String, objDas As New DBAccess, dt As DataTable
            'sSQL = "SELECT MAX(Srno) AS Srno FROM Register "
            sSQL = "SELECT Count(RegID) as ID FROM Register Where Productcd = '" & Trim(Product) & "' "
            dt = objDas.GetDataTable(sSQL)
            If dt.Rows.Count > 0 Then
                If Not IsDBNull(dt.Rows(0).Item("ID")) Then
                    If dt.Rows(0).Item("ID").ToString <> "" Then
                        GetDocCodeForClientReg = dt.Rows(0)("ID").ToString + 1
                    Else
                        GetDocCodeForClientReg = 1
                    End If
                Else
                    GetDocCodeForClientReg = 1
                End If
            End If
            Return GetDocCodeForClientReg
        End Function

        'Public Shared Function Generate_Docno_ForClient_Reg(ByVal paramno As Integer, ByVal loccd As String, ByVal Productcd As String)
        '    Try
        '        Dim startyr, endyr, doccode As String
        '        Dim ccode, LSN, PSN, docsrno As String

        '        Call DBAccess.Find_company()
        '        ccode = DBAccess.CmpCode
        '        Call DBAccess.Find_LocationShortName(loccd)
        '        LSN = DBAccess.LocationShortName
        '        Call DBAccess.Find_ProductShortName(Productcd)
        '        PSN = DBAccess.ProductShortName

        '        startyr = Right(Trim(DBAccess.FinStart), 2)
        '        endyr = Right(Trim(DBAccess.FinEnd), 2)
        '        docsrno = DocumentSrno(paramno, 1)

        '        Generate_Docno_ForClient_Reg = Trim(ccode) + "/" + Trim(LSN) + "/" + Trim(startyr) + "-" + Trim(endyr) + "/" + Trim(PSN) + "/" + Trim(docsrno)
        '    Catch ex As Exception
        '        Throw ex
        '    End Try
        'End Function

        Public Shared Function Generate_Docno_ForClient_Reg(ByVal paramno As Integer, ByVal Product As String)
            Try
                Dim startyr, endyr, docsrno, ccode As String
                Call DBAccess.Find_company()
                ccode = DBAccess.CmpCode
                startyr = Right(Trim(DBAccess.FinStart), 2)
                endyr = Right(Trim(DBAccess.FinEnd), 2)
                docsrno = DocumentSrno(paramno, 1)
                'Generate_Docno_ForGPReg = Trim(loccd) + "/" + Trim(docsrno)
                Generate_Docno_ForClient_Reg = Trim(ccode) & Trim(startyr) & Trim(endyr) & "/" & Trim(Product) & "/" & Trim(docsrno)
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function DocumentSrno_ForClientReg(ByVal p As Integer, ByVal strlen As Integer) As String
            If strlen > Len(CStr(p)) Then
                DocumentSrno_ForClientReg = StrDup(strlen - Len(CStr(p)), "0") + CStr(p)
            Else
                DocumentSrno_ForClientReg = CStr(p)
            End If
        End Function

        Public Shared Function GetDataAllFor_Client_Register(ByVal contactcd As String, ByVal RegID As String, ByVal Flag As String) As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@RegID", RegID))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_Client_GetData_Register")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function FillData_Client_Registration(ByVal contactcd As String, ByVal RegID As String, ByVal Flag As String) As ClsCRMContactForGPAndClient_All_New
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@RegID", RegID))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_Client_GetData_Register")
                If dt.Rows.Count > 0 Then
                    Dim obj As ClsCRMContactForGPAndClient_All_New = New ClsCRMContactForGPAndClient_All_New
                    '' GP Registration Details
                    If Not IsDBNull(dt.Rows(0)("contactcd")) Then
                        obj.Contactcd = dt.Rows(0)("contactcd").ToString
                    End If
                    If Not IsDBNull(dt.Rows(0)("RegID")) Then
                        obj.RegID = dt.Rows(0)("RegID").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RegDate").ToString) Then
                        obj.RegDate = ""
                    Else
                        obj.RegDate = dt.Rows(0)("RegDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ProgramID").ToString) Then
                        obj.ProgramID = ""
                    Else
                        obj.ProgramID = dt.Rows(0)("ProgramID").ToString
                    End If
                    'If IsDBNull(dt.Rows(0)("BatchID").ToString) Then
                    '    obj.BatchID = ""
                    'Else
                    '    obj.BatchID = dt.Rows(0)("BatchID").ToString
                    'End If
                    If IsDBNull(dt.Rows(0)("ProgramDate").ToString) Then
                        obj.ProgramDate = ""
                    Else
                        obj.ProgramDate = dt.Rows(0)("ProgramDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ProgramTime").ToString) Then
                        obj.ProgramTime = ""
                    Else
                        obj.ProgramTime = dt.Rows(0)("ProgramTime").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("HR").ToString) Then
                        obj.HR = ""
                    Else
                        obj.HR = dt.Rows(0)("HR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Mi").ToString) Then
                        obj.Mi = ""
                    Else
                        obj.Mi = dt.Rows(0)("Mi").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AP").ToString) Then
                        obj.AP = ""
                    Else
                        obj.AP = dt.Rows(0)("AP").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("loccd").ToString) Then
                        obj.loccd = ""
                    Else
                        obj.loccd = dt.Rows(0)("loccd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("VenueCode").ToString) Then
                        obj.VenueCode = ""
                    Else
                        obj.VenueCode = dt.Rows(0)("VenueCode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TrainerCd").ToString) Then
                        obj.TrainerCd = ""
                    Else
                        obj.TrainerCd = dt.Rows(0)("TrainerCd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("PlanName").ToString) Then
                        obj.PlanName = ""
                    Else
                        obj.PlanName = dt.Rows(0)("PlanName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("productcd").ToString) Then
                        obj.productcd = ""
                    Else
                        obj.productcd = dt.Rows(0)("productcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GST").ToString) Then
                        obj.GST = ""
                    Else
                        obj.GST = dt.Rows(0)("GST").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TDSDeducted").ToString) Then
                        obj.TDSDeducted = ""
                    Else
                        obj.TDSDeducted = dt.Rows(0)("TDSDeducted").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmount").ToString) Then
                        obj.TotalAmount = 0
                    Else
                        obj.TotalAmount = dt.Rows(0)("TotalAmount").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmtAfterTDS").ToString) Then
                        obj.TotalAmtAfterTDS = 0
                    Else
                        obj.TotalAmtAfterTDS = dt.Rows(0)("TotalAmtAfterTDS").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmtInWords").ToString) Then
                        obj.TotalAmtInWords = ""
                    Else
                        obj.TotalAmtInWords = dt.Rows(0)("TotalAmtInWords").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TypeOfPayment").ToString) Then
                        obj.TypeOfPayment = ""
                    Else
                        obj.TypeOfPayment = dt.Rows(0)("TypeOfPayment").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("PaymentOtherDetails").ToString) Then
                        obj.PaymentOtherDetails = ""
                    Else
                        obj.PaymentOtherDetails = dt.Rows(0)("PaymentOtherDetails").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ModeOfPayment").ToString) Then
                        obj.ModeOfPayment = ""
                    Else
                        obj.ModeOfPayment = dt.Rows(0)("ModeOfPayment").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GrideTotalAmt").ToString) Then
                        obj.GrideTotalAmt = 0
                    Else
                        obj.GrideTotalAmt = dt.Rows(0)("GrideTotalAmt").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AdjAmount").ToString) Then
                        obj.AdjAmount = 0
                    Else
                        obj.AdjAmount = dt.Rows(0)("AdjAmount").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BalAmt").ToString) Then
                        obj.BalAmt = 0
                    Else
                        obj.BalAmt = dt.Rows(0)("BalAmt").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CallDate").ToString) Then
                        obj.CallDate = ""
                    Else
                        obj.CallDate = dt.Rows(0)("CallDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CallTime").ToString) Then
                        obj.CallTime = ""
                    Else
                        obj.CallTime = dt.Rows(0)("CallTime").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BHR").ToString) Then
                        obj.BHR = ""
                    Else
                        obj.BHR = dt.Rows(0)("BHR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BMi").ToString) Then
                        obj.BMi = ""
                    Else
                        obj.BMi = dt.Rows(0)("BMi").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BAP").ToString) Then
                        obj.BAP = ""
                    Else
                        obj.BAP = dt.Rows(0)("BAP").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("Comments").ToString) Then
                        obj.Comments = ""
                    Else
                        obj.Comments = dt.Rows(0)("Comments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetVerify").ToString) Then
                        obj.OtherDetVerify = ""
                    Else
                        obj.OtherDetVerify = dt.Rows(0)("OtherDetVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetComments").ToString) Then
                        obj.OtherDetComments = ""
                    Else
                        obj.OtherDetComments = dt.Rows(0)("OtherDetComments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignVerify").ToString) Then
                        obj.RSignVerify = ""
                    Else
                        obj.RSignVerify = dt.Rows(0)("SignVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignComments").ToString) Then
                        obj.RSignComments = ""
                    Else
                        obj.RSignComments = dt.Rows(0)("SignComments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RegType").ToString) Then
                        obj.RegType = ""
                    Else
                        obj.RegType = dt.Rows(0)("RegType").ToString
                    End If


                    If IsDBNull(dt.Rows(0)("JointAdmConactcd").ToString) Then
                        obj.JointAdmConactcd = ""
                    Else
                        obj.JointAdmConactcd = dt.Rows(0)("JointAdmConactcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Sourcecd").ToString) Then
                        obj.Sourcecd = ""
                    Else
                        obj.Sourcecd = dt.Rows(0)("Sourcecd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("refbyContactcd").ToString) Then
                        obj.refbyContactcd = ""
                    Else
                        obj.refbyContactcd = dt.Rows(0)("refbyContactcd").ToString
                    End If
                    'If IsDBNull(dt.Rows(0)("RefFreeText").ToString) Then
                    '    obj.RefFreeText = ""
                    'Else
                    '    obj.RefFreeText = dt.Rows(0)("RefFreeText").ToString
                    'End If
                    If IsDBNull(dt.Rows(0)("ServiceTax").ToString) Then
                        obj.ServiceTax = ""
                    Else
                        obj.ServiceTax = dt.Rows(0)("ServiceTax").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("DateOfEntry").ToString) Then
                        obj.DateOfEntry = ""
                    Else
                        obj.DateOfEntry = dt.Rows(0)("DateOfEntry").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CustPlanName").ToString) Then
                        obj.CustPlanName = ""
                    Else
                        obj.CustPlanName = dt.Rows(0)("CustPlanName").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("BatchID").ToString) Then
                        obj.BatchID = ""
                    Else
                        obj.BatchID = dt.Rows(0)("BatchID").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BatchRegDate").ToString) Then
                        obj.BatchRegDate = ""
                    Else
                        obj.BatchRegDate = dt.Rows(0)("BatchRegDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("loccd").ToString) Then
                        obj.loccd = ""
                    Else
                        obj.loccd = dt.Rows(0)("loccd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BrHR").ToString) Then
                        obj.BrHR = ""
                    Else
                        obj.BrHR = dt.Rows(0)("BrHR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BrMi").ToString) Then
                        obj.BrMi = ""
                    Else
                        obj.BrMi = dt.Rows(0)("BrMi").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("SSPartName1").ToString) Then
                        obj.SSPartName1 = ""
                    Else
                        obj.SSPartName1 = dt.Rows(0)("SSPartName1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartDesignation1").ToString) Then
                        obj.SSPartDesignation1 = ""
                    Else
                        obj.SSPartDesignation1 = dt.Rows(0)("SSPartDesignation1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartCompanyName1").ToString) Then
                        obj.SSPartCompanyName1 = ""
                    Else
                        obj.SSPartCompanyName1 = dt.Rows(0)("SSPartCompanyName1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartContactNo1").ToString) Then
                        obj.SSPartContactNo1 = ""
                    Else
                        obj.SSPartContactNo1 = dt.Rows(0)("SSPartContactNo1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartRelationship1").ToString) Then
                        obj.SSPartRelationship1 = ""
                    Else
                        obj.SSPartRelationship1 = dt.Rows(0)("SSPartRelationship1").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("SSPartName2").ToString) Then
                        obj.SSPartName2 = ""
                    Else
                        obj.SSPartName2 = dt.Rows(0)("SSPartName2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartDesignation2").ToString) Then
                        obj.SSPartDesignation2 = ""
                    Else
                        obj.SSPartDesignation2 = dt.Rows(0)("SSPartDesignation2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartCompanyName2").ToString) Then
                        obj.SSPartCompanyName2 = ""
                    Else
                        obj.SSPartCompanyName2 = dt.Rows(0)("SSPartCompanyName2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartContactNo2").ToString) Then
                        obj.SSPartContactNo2 = ""
                    Else
                        obj.SSPartContactNo2 = dt.Rows(0)("SSPartContactNo2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartRelationship2").ToString) Then
                        obj.SSPartRelationship2 = ""
                    Else
                        obj.SSPartRelationship2 = dt.Rows(0)("SSPartRelationship2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("empcdConst").ToString) Then
                        obj.empcdConst = ""
                    Else
                        obj.empcdConst = dt.Rows(0)("empcdConst").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("InvoiceRemark").ToString) Then
                        obj.InvoiceRemark = ""
                    Else
                        obj.InvoiceRemark = dt.Rows(0)("InvoiceRemark").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("tallyrefno").ToString) Then
                        obj.tallyrefno = ""
                    Else
                        obj.tallyrefno = dt.Rows(0)("tallyrefno").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("invdt").ToString) Then
                        obj.invdt = ""
                    Else
                        obj.invdt = dt.Rows(0)("invdt").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("invoicingtype").ToString) Then
                        obj.invoicingtype = ""
                    Else
                        obj.invoicingtype = dt.Rows(0)("invoicingtype").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("addAttachmentName").ToString) Then
                        obj.addAttachmentName = ""
                    Else
                        obj.addAttachmentName = dt.Rows(0)("addAttachmentName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("addAttachmentPath").ToString) Then
                        obj.addAttachmentPath = ""
                    Else
                        obj.addAttachmentPath = dt.Rows(0)("addAttachmentPath").ToString
                    End If
                    Return obj
                Else
                    Return Nothing
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function GetDataForGride_Client_Register() As DataSet
            Dim dadet As New SqlDataAdapter
            Dim con As SqlConnection
            Dim comdet As SqlCommand
            Dim ds As DataSet

            con = GetConnection()
            comdet = GetCommand()
            ds = New DataSet

            comdet.Connection = con
            comdet.CommandType = CommandType.Text
            comdet.CommandText = "select * from RegisterDet where RegID='" & Trim(docno_RegID) & "' order by srno desc"
            dadet.SelectCommand = comdet

            Try
                dadet.Fill(ds, "RegisterDet")
            Catch ex As Exception
                Throw ex
            Finally
                con.Close()
                con = Nothing
                comdet = Nothing
                dadet = Nothing
            End Try
            Return ds
        End Function

        Public Shared Function Update_Data_Client_Registration(ByVal o As ClsCRMContactForGPAndClient_All_New, ByVal ds As DataSet, ByVal mode As String) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim dadet As New SqlDataAdapter
            Dim comdetold As SqlCommand
            Dim comdet As SqlCommand
            Dim cbdet As SqlCommandBuilder
            Dim Com1, Com2, Com7, Com8 As SqlCommand
            Dim Ssql1, Ssql2, Ssql3, Ssql7, Ssql8 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            comdet = New SqlCommand
            comdet.Connection = Con
            comdet.CommandType = CommandType.Text
            Ssql2 = "Select * From RegisterDet Where RegID='" & Trim(docno_RegID) & "'"
            comdet.CommandText = Ssql2
            comdet.Transaction = Trans

            comdetold = New SqlCommand
            comdetold.Connection = Con
            comdetold.CommandType = CommandType.Text
            Ssql3 = "Delete From RegisterDet Where RegID='" & Trim(docno_RegID) & "'"
            comdetold.CommandText = Ssql3
            comdetold.Transaction = Trans

            dadet.SelectCommand = comdet
            cbdet = New SqlCommandBuilder(dadet)

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            Com2 = New SqlCommand
            Com2.Connection = Con
            Com2.CommandType = CommandType.Text

            Com7 = New SqlCommand
            Com7.Connection = Con
            Com7.CommandType = CommandType.StoredProcedure

            Com8 = New SqlCommand
            Com8.Connection = Con
            Com8.CommandType = CommandType.StoredProcedure

            Com1.Parameters.Add(New SqlParameter("@Srno", o.Srno))
            Com1.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            Com1.Parameters.Add(New SqlParameter("@RegID", o.RegID))
            Com1.Parameters.Add(New SqlParameter("@RegDate", o.RegDate))
            Com1.Parameters.Add(New SqlParameter("@ProgramID", System.DBNull.Value))
            'Com1.Parameters.Add(New SqlParameter("@BatchID", o.BatchID))
            Com1.Parameters.Add(New SqlParameter("@ProgramDate", System.DBNull.Value))
            Com1.Parameters.Add(New SqlParameter("@ProgramTime", System.DBNull.Value))
            'If Trim(o.loccd) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@loccd", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@loccd", o.loccd))
            'End If
            'If Trim(o.VenueCode) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@VenueCode", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@VenueCode", o.VenueCode))
            'End If
            Com1.Parameters.Add(New SqlParameter("@VenueCode", System.DBNull.Value))

            'If Trim(o.TrainerCd) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@TrainerCd", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@TrainerCd", o.TrainerCd))
            'End If
            Com1.Parameters.Add(New SqlParameter("@TrainerCd", System.DBNull.Value))

            If Trim(o.PlanName) = "" Then
                Com1.Parameters.Add(New SqlParameter("@PlanName", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@PlanName", o.PlanName))
            End If
            If Trim(o.productcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@productcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@productcd", o.productcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@GST", System.DBNull.Value))
            Com1.Parameters.Add(New SqlParameter("@TDSDeducted", o.TDSDeducted))
            Com1.Parameters.Add(New SqlParameter("@TotalAmount", o.TotalAmount))
            Com1.Parameters.Add(New SqlParameter("@TotalAmtAfterTDS", o.TotalAmtAfterTDS))
            Com1.Parameters.Add(New SqlParameter("@TotalAmtInWords", o.TotalAmtInWords))
            Com1.Parameters.Add(New SqlParameter("@TypeOfPayment", o.TypeOfPayment))
            Com1.Parameters.Add(New SqlParameter("@ModeOfPayment", o.ModeOfPayment))
            Com1.Parameters.Add(New SqlParameter("@GrideTotalAmt", o.GrideTotalAmt))
            Com1.Parameters.Add(New SqlParameter("@AdjAmount", o.AdjAmount))
            Com1.Parameters.Add(New SqlParameter("@BalAmt", o.BalAmt))
            If Trim(o.CallDate) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CallDate", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CallDate", o.CallDate))
            End If
            If Trim(o.CallTime) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CallTime", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CallTime", o.CallTime))
            End If
            Com1.Parameters.Add(New SqlParameter("@Comments", o.Comments))
            Com1.Parameters.Add(New SqlParameter("@OtherDetVerify", o.OtherDetVerify))
            Com1.Parameters.Add(New SqlParameter("@OtherDetComments", o.OtherDetComments))
            Com1.Parameters.Add(New SqlParameter("@SignVerify", o.RSignVerify))
            Com1.Parameters.Add(New SqlParameter("@SignComments", o.RSignComments))
            Com1.Parameters.Add(New SqlParameter("@RegType", o.RegType))
            Com1.Parameters.Add(New SqlParameter("@bhcode", o.bhcode))
            Com1.Parameters.Add(New SqlParameter("@PaymentOtherDetails", o.PaymentOtherDetails))

            If Trim(o.JointAdmConactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@JointAdmConactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@JointAdmConactcd", o.JointAdmConactcd))
            End If
            If Trim(o.Sourcecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", o.Sourcecd))
            End If
            If Trim(o.refbyContactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", o.refbyContactcd))
            End If
            'If Trim(o.RefFreeText) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@RefFreeText", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@RefFreeText", o.RefFreeText))
            'End If
            If Trim(o.ServiceTax) = "" Then
                Com1.Parameters.Add(New SqlParameter("@ServiceTax", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@ServiceTax", o.ServiceTax))
            End If
            If Trim(o.DateOfEntry) = "" Then
                Com1.Parameters.Add(New SqlParameter("@DateOfEntry", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@DateOfEntry", o.DateOfEntry))
            End If
            If Trim(o.CustPlanName) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CustPlanName", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CustPlanName", o.CustPlanName))
            End If

            If o.BatchID = "" Then
                Com1.Parameters.Add(New SqlParameter("@BatchID", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@BatchID", o.BatchID))
            End If
            If o.BatchRegDate = "" Then
                Com1.Parameters.Add(New SqlParameter("@BatchRegDate", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@BatchRegDate", o.BatchRegDate))
            End If
            If o.BatchRegTime = "" Then
                Com1.Parameters.Add(New SqlParameter("@BatchRegTime", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@BatchRegTime", o.BatchRegTime))
            End If
            If o.loccd = "" Then
                Com1.Parameters.Add(New SqlParameter("@loccd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@loccd", o.loccd))
            End If

            If o.SSPartName1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartName1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartName1", o.SSPartName1))
            End If
            If o.SSPartDesignation1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation1", o.SSPartDesignation1))
            End If
            If o.SSPartCompanyName1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName1", o.SSPartCompanyName1))
            End If
            If o.SSPartContactNo1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo1", o.SSPartContactNo1))
            End If
            If o.SSPartRelationship1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship1", o.SSPartRelationship1))
            End If
            If o.SSPartName2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartName2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartName2", o.SSPartName2))
            End If
            If o.SSPartDesignation2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation2", o.SSPartDesignation2))
            End If
            If o.SSPartCompanyName2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName2", o.SSPartCompanyName2))
            End If
            If o.SSPartContactNo2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo2", o.SSPartContactNo2))
            End If
            If o.SSPartRelationship2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship2", o.SSPartRelationship2))
            End If
            If o.empcdConst = "" Then
                Com1.Parameters.Add(New SqlParameter("@empcdConst", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@empcdConst", o.empcdConst))
            End If
            If o.InvoiceRemark = "" Then
                Com1.Parameters.Add(New SqlParameter("@InvoiceRemark", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@InvoiceRemark", o.InvoiceRemark))
            End If

            Com1.Parameters.Add(New SqlParameter("@invoicingtype", o.invoicingtype))

            Com1.Parameters.Add(New SqlParameter("@crtuserid", o.crtuserid))
            Com1.Parameters.Add(New SqlParameter("@crtuserdt", o.crtuserdt))
            Com1.Parameters.Add(New SqlParameter("@moduserid", o.moduserid))
            Com1.Parameters.Add(New SqlParameter("@moduserdt", o.moduserdt))

            Com7.Parameters.Add(New SqlParameter("@Contactcd", o.Contactcd))
            Com7.Parameters.Add(New SqlParameter("@regid", o.RegID))
            If Trim(o.UploadAttName) <> "" Then
                Com7.Parameters.Add(New SqlParameter("@UploadAttName", o.UploadAttName))
            Else
                Com7.Parameters.Add(New SqlParameter("@UploadAttName", System.DBNull.Value))
            End If
            If Trim(o.UploadAttPath) <> "" Then
                Com7.Parameters.Add(New SqlParameter("@UploadAttPath", o.UploadAttPath))
            Else
                Com7.Parameters.Add(New SqlParameter("@UploadAttPath", System.DBNull.Value))
            End If


            Com8.Parameters.Add(New SqlParameter("@Contactcd", o.Contactcd))
            Com8.Parameters.Add(New SqlParameter("@regid", o.RegID))
            If Trim(o.addAttachmentName) <> "" Then
                Com8.Parameters.Add(New SqlParameter("@addAttachmentName", o.addAttachmentName))
            Else
                Com8.Parameters.Add(New SqlParameter("@addAttachmentName", System.DBNull.Value))
            End If
            If Trim(o.addAttachmentPath) <> "" Then
                Com8.Parameters.Add(New SqlParameter("@addAttachmentPath", o.addAttachmentPath))
            Else
                Com8.Parameters.Add(New SqlParameter("@addAttachmentPath", System.DBNull.Value))
            End If

            If UCase(mode.Trim) = "ADD" Then
                Com1.Parameters.Add(New SqlParameter("@Flag", "A"))
            Else
                Com1.Parameters.Add(New SqlParameter("@Flag", "E"))
            End If

            Ssql1 = "Sp_crmContacts_Client_AE_Register"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            Ssql2 = "Update crmcontacts Set OpenLock = 0 where contactcd ='" & Trim(o.Contactcd) & "' "
            Com2.CommandText = Ssql2
            Com2.Transaction = Trans

            Ssql7 = "Sp_crmContacts_Client_UploadAtt_Register_SFB"
            Com7.CommandText = Ssql7
            Com7.Transaction = Trans

            Ssql8 = "Sp_crmContacts_Client_UploadAddAtt_Register_SFB"
            Com8.CommandText = Ssql8
            Com8.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                i = Com2.ExecuteNonQuery()
                i = Com7.ExecuteNonQuery()
                i = Com8.ExecuteNonQuery()
                If UCase(mode.Trim) = "ADD" Then
                Else
                    comdetold.ExecuteNonQuery()
                End If
                i = dadet.Update(ds, "RegisterDet")
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Com2 = Nothing
                Com7 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function

        Public Shared Function Client_Reg_Delete(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            db.Parameters.Add(New SqlParameter("@RegID", o.RegID))
            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_Client_Delete_Register")
            Return retval
        End Function

        '' Start Client Registration for SFB
        Public Shared Function FillData_Client_Registration_SFB(ByVal contactcd As String, ByVal RegID As String, ByVal Flag As String) As ClsCRMContactForGPAndClient_All_New
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@contactcd", contactcd))
                db.Parameters.Add(New SqlParameter("@RegID", RegID))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_Client_GetData_Register_SFB")
                If dt.Rows.Count > 0 Then
                    Dim obj As ClsCRMContactForGPAndClient_All_New = New ClsCRMContactForGPAndClient_All_New
                    '' GP Registration Details
                    If Not IsDBNull(dt.Rows(0)("contactcd")) Then
                        obj.Contactcd = dt.Rows(0)("contactcd").ToString
                    End If
                    If Not IsDBNull(dt.Rows(0)("RegID")) Then
                        obj.RegID = dt.Rows(0)("RegID").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RegDate").ToString) Then
                        obj.RegDate = ""
                    Else
                        obj.RegDate = dt.Rows(0)("RegDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ProgramID").ToString) Then
                        obj.ProgramID = ""
                    Else
                        obj.ProgramID = dt.Rows(0)("ProgramID").ToString
                    End If
                    'If IsDBNull(dt.Rows(0)("BatchID").ToString) Then
                    '    obj.BatchID = ""
                    'Else
                    '    obj.BatchID = dt.Rows(0)("BatchID").ToString
                    'End If
                    If IsDBNull(dt.Rows(0)("ProgramDate").ToString) Then
                        obj.ProgramDate = ""
                    Else
                        obj.ProgramDate = dt.Rows(0)("ProgramDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ProgramTime").ToString) Then
                        obj.ProgramTime = ""
                    Else
                        obj.ProgramTime = dt.Rows(0)("ProgramTime").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("HR").ToString) Then
                        obj.HR = ""
                    Else
                        obj.HR = dt.Rows(0)("HR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Mi").ToString) Then
                        obj.Mi = ""
                    Else
                        obj.Mi = dt.Rows(0)("Mi").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AP").ToString) Then
                        obj.AP = ""
                    Else
                        obj.AP = dt.Rows(0)("AP").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("loccd").ToString) Then
                        obj.loccd = ""
                    Else
                        obj.loccd = dt.Rows(0)("loccd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("VenueCode").ToString) Then
                        obj.VenueCode = ""
                    Else
                        obj.VenueCode = dt.Rows(0)("VenueCode").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TrainerCd").ToString) Then
                        obj.TrainerCd = ""
                    Else
                        obj.TrainerCd = dt.Rows(0)("TrainerCd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("PlanName").ToString) Then
                        obj.PlanName = ""
                    Else
                        obj.PlanName = dt.Rows(0)("PlanName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("productcd").ToString) Then
                        obj.productcd = ""
                    Else
                        obj.productcd = dt.Rows(0)("productcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GST").ToString) Then
                        obj.GST = ""
                    Else
                        obj.GST = dt.Rows(0)("GST").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TDSDeducted").ToString) Then
                        obj.TDSDeducted = ""
                    Else
                        obj.TDSDeducted = dt.Rows(0)("TDSDeducted").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmount").ToString) Then
                        obj.TotalAmount = 0
                    Else
                        obj.TotalAmount = dt.Rows(0)("TotalAmount").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmtAfterTDS").ToString) Then
                        obj.TotalAmtAfterTDS = 0
                    Else
                        obj.TotalAmtAfterTDS = dt.Rows(0)("TotalAmtAfterTDS").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TotalAmtInWords").ToString) Then
                        obj.TotalAmtInWords = ""
                    Else
                        obj.TotalAmtInWords = dt.Rows(0)("TotalAmtInWords").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("TypeOfPayment").ToString) Then
                        obj.TypeOfPayment = ""
                    Else
                        obj.TypeOfPayment = dt.Rows(0)("TypeOfPayment").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("PaymentOtherDetails").ToString) Then
                        obj.PaymentOtherDetails = ""
                    Else
                        obj.PaymentOtherDetails = dt.Rows(0)("PaymentOtherDetails").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("ModeOfPayment").ToString) Then
                        obj.ModeOfPayment = ""
                    Else
                        obj.ModeOfPayment = dt.Rows(0)("ModeOfPayment").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("GrideTotalAmt").ToString) Then
                        obj.GrideTotalAmt = 0
                    Else
                        obj.GrideTotalAmt = dt.Rows(0)("GrideTotalAmt").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("AdjAmount").ToString) Then
                        obj.AdjAmount = 0
                    Else
                        obj.AdjAmount = dt.Rows(0)("AdjAmount").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BalAmt").ToString) Then
                        obj.BalAmt = 0
                    Else
                        obj.BalAmt = dt.Rows(0)("BalAmt").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CallDate").ToString) Then
                        obj.CallDate = ""
                    Else
                        obj.CallDate = dt.Rows(0)("CallDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CallTime").ToString) Then
                        obj.CallTime = ""
                    Else
                        obj.CallTime = dt.Rows(0)("CallTime").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BHR").ToString) Then
                        obj.BHR = ""
                    Else
                        obj.BHR = dt.Rows(0)("BHR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BMi").ToString) Then
                        obj.BMi = ""
                    Else
                        obj.BMi = dt.Rows(0)("BMi").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BAP").ToString) Then
                        obj.BAP = ""
                    Else
                        obj.BAP = dt.Rows(0)("BAP").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("Comments").ToString) Then
                        obj.Comments = ""
                    Else
                        obj.Comments = dt.Rows(0)("Comments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetVerify").ToString) Then
                        obj.OtherDetVerify = ""
                    Else
                        obj.OtherDetVerify = dt.Rows(0)("OtherDetVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("OtherDetComments").ToString) Then
                        obj.OtherDetComments = ""
                    Else
                        obj.OtherDetComments = dt.Rows(0)("OtherDetComments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignVerify").ToString) Then
                        obj.RSignVerify = ""
                    Else
                        obj.RSignVerify = dt.Rows(0)("SignVerify").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SignComments").ToString) Then
                        obj.RSignComments = ""
                    Else
                        obj.RSignComments = dt.Rows(0)("SignComments").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("RegType").ToString) Then
                        obj.RegType = ""
                    Else
                        obj.RegType = dt.Rows(0)("RegType").ToString
                    End If


                    If IsDBNull(dt.Rows(0)("JointAdmConactcd").ToString) Then
                        obj.JointAdmConactcd = ""
                    Else
                        obj.JointAdmConactcd = dt.Rows(0)("JointAdmConactcd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("Sourcecd").ToString) Then
                        obj.Sourcecd = ""
                    Else
                        obj.Sourcecd = dt.Rows(0)("Sourcecd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("refbyContactcd").ToString) Then
                        obj.refbyContactcd = ""
                    Else
                        obj.refbyContactcd = dt.Rows(0)("refbyContactcd").ToString
                    End If
                    'If IsDBNull(dt.Rows(0)("RefFreeText").ToString) Then
                    '    obj.RefFreeText = ""
                    'Else
                    '    obj.RefFreeText = dt.Rows(0)("RefFreeText").ToString
                    'End If
                    If IsDBNull(dt.Rows(0)("ServiceTax").ToString) Then
                        obj.ServiceTax = ""
                    Else
                        obj.ServiceTax = dt.Rows(0)("ServiceTax").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("DateOfEntry").ToString) Then
                        obj.DateOfEntry = ""
                    Else
                        obj.DateOfEntry = dt.Rows(0)("DateOfEntry").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("CustPlanName").ToString) Then
                        obj.CustPlanName = ""
                    Else
                        obj.CustPlanName = dt.Rows(0)("CustPlanName").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("BatchID").ToString) Then
                        obj.BatchID = ""
                    Else
                        obj.BatchID = dt.Rows(0)("BatchID").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BatchRegDate").ToString) Then
                        obj.BatchRegDate = ""
                    Else
                        obj.BatchRegDate = dt.Rows(0)("BatchRegDate").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("loccd").ToString) Then
                        obj.loccd = ""
                    Else
                        obj.loccd = dt.Rows(0)("loccd").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BrHR").ToString) Then
                        obj.BrHR = ""
                    Else
                        obj.BrHR = dt.Rows(0)("BrHR").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("BrMi").ToString) Then
                        obj.BrMi = ""
                    Else
                        obj.BrMi = dt.Rows(0)("BrMi").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("SSPartName1").ToString) Then
                        obj.SSPartName1 = ""
                    Else
                        obj.SSPartName1 = dt.Rows(0)("SSPartName1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartDesignation1").ToString) Then
                        obj.SSPartDesignation1 = ""
                    Else
                        obj.SSPartDesignation1 = dt.Rows(0)("SSPartDesignation1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartCompanyName1").ToString) Then
                        obj.SSPartCompanyName1 = ""
                    Else
                        obj.SSPartCompanyName1 = dt.Rows(0)("SSPartCompanyName1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartContactNo1").ToString) Then
                        obj.SSPartContactNo1 = ""
                    Else
                        obj.SSPartContactNo1 = dt.Rows(0)("SSPartContactNo1").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartRelationship1").ToString) Then
                        obj.SSPartRelationship1 = ""
                    Else
                        obj.SSPartRelationship1 = dt.Rows(0)("SSPartRelationship1").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("SSPartName2").ToString) Then
                        obj.SSPartName2 = ""
                    Else
                        obj.SSPartName2 = dt.Rows(0)("SSPartName2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartDesignation2").ToString) Then
                        obj.SSPartDesignation2 = ""
                    Else
                        obj.SSPartDesignation2 = dt.Rows(0)("SSPartDesignation2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartCompanyName2").ToString) Then
                        obj.SSPartCompanyName2 = ""
                    Else
                        obj.SSPartCompanyName2 = dt.Rows(0)("SSPartCompanyName2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartContactNo2").ToString) Then
                        obj.SSPartContactNo2 = ""
                    Else
                        obj.SSPartContactNo2 = dt.Rows(0)("SSPartContactNo2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("SSPartRelationship2").ToString) Then
                        obj.SSPartRelationship2 = ""
                    Else
                        obj.SSPartRelationship2 = dt.Rows(0)("SSPartRelationship2").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("empcdConst").ToString) Then
                        obj.empcdConst = ""
                    Else
                        obj.empcdConst = dt.Rows(0)("empcdConst").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("InvoiceRemark").ToString) Then
                        obj.InvoiceRemark = ""
                    Else
                        obj.InvoiceRemark = dt.Rows(0)("InvoiceRemark").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("tallyrefno").ToString) Then
                        obj.tallyrefno = ""
                    Else
                        obj.tallyrefno = dt.Rows(0)("tallyrefno").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("UploadAttName").ToString) Then
                        obj.UploadAttName = ""
                    Else
                        obj.UploadAttName = dt.Rows(0)("UploadAttName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("UploadAttPath").ToString) Then
                        obj.UploadAttPath = ""
                    Else
                        obj.UploadAttPath = dt.Rows(0)("UploadAttPath").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("invdt").ToString) Then
                        obj.invdt = ""
                    Else
                        obj.invdt = dt.Rows(0)("invdt").ToString
                    End If

                    If IsDBNull(dt.Rows(0)("invoicingtype").ToString) Then
                        obj.invoicingtype = ""
                    Else
                        obj.invoicingtype = dt.Rows(0)("invoicingtype").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("addAttachmentName").ToString) Then
                        obj.addAttachmentName = ""
                    Else
                        obj.addAttachmentName = dt.Rows(0)("addAttachmentName").ToString
                    End If
                    If IsDBNull(dt.Rows(0)("addAttachmentPath").ToString) Then
                        obj.addAttachmentPath = ""
                    Else
                        obj.addAttachmentPath = dt.Rows(0)("addAttachmentPath").ToString
                    End If
                    Return obj
                Else
                    Return Nothing
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Update_Data_Client_Registration_SFB(ByVal o As ClsCRMContactForGPAndClient_All_New, ByVal ds As DataSet, ByVal mode As String) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim dadet As New SqlDataAdapter
            Dim comdetold As SqlCommand
            Dim comdet As SqlCommand
            Dim cbdet As SqlCommandBuilder
            Dim Com1, Com2, Com7, Com8 As SqlCommand
            Dim Ssql1, Ssql2, Ssql3, Ssql7, Ssql8 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            comdet = New SqlCommand
            comdet.Connection = Con
            comdet.CommandType = CommandType.Text
            Ssql2 = "Select * From RegisterDet Where RegID='" & Trim(docno_RegID) & "'"
            comdet.CommandText = Ssql2
            comdet.Transaction = Trans

            comdetold = New SqlCommand
            comdetold.Connection = Con
            comdetold.CommandType = CommandType.Text
            Ssql3 = "Delete From RegisterDet Where RegID='" & Trim(docno_RegID) & "'"
            comdetold.CommandText = Ssql3
            comdetold.Transaction = Trans

            dadet.SelectCommand = comdet
            cbdet = New SqlCommandBuilder(dadet)

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            Com2 = New SqlCommand
            Com2.Connection = Con
            Com2.CommandType = CommandType.Text

            Com7 = New SqlCommand
            Com7.Connection = Con
            Com7.CommandType = CommandType.StoredProcedure

            Com8 = New SqlCommand
            Com8.Connection = Con
            Com8.CommandType = CommandType.StoredProcedure

            Com1.Parameters.Add(New SqlParameter("@Srno", o.Srno))
            Com1.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            Com1.Parameters.Add(New SqlParameter("@RegID", o.RegID))
            Com1.Parameters.Add(New SqlParameter("@RegDate", o.RegDate))
            Com1.Parameters.Add(New SqlParameter("@ProgramID", System.DBNull.Value))
            'Com1.Parameters.Add(New SqlParameter("@BatchID", o.BatchID))
            Com1.Parameters.Add(New SqlParameter("@ProgramDate", System.DBNull.Value))
            Com1.Parameters.Add(New SqlParameter("@ProgramTime", System.DBNull.Value))
            'If Trim(o.loccd) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@loccd", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@loccd", o.loccd))
            'End If
            'If Trim(o.VenueCode) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@VenueCode", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@VenueCode", o.VenueCode))
            'End If
            Com1.Parameters.Add(New SqlParameter("@VenueCode", System.DBNull.Value))

            'If Trim(o.TrainerCd) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@TrainerCd", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@TrainerCd", o.TrainerCd))
            'End If
            Com1.Parameters.Add(New SqlParameter("@TrainerCd", System.DBNull.Value))

            If Trim(o.PlanName) = "" Then
                Com1.Parameters.Add(New SqlParameter("@PlanName", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@PlanName", o.PlanName))
            End If
            If Trim(o.productcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@productcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@productcd", o.productcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@GST", System.DBNull.Value))
            Com1.Parameters.Add(New SqlParameter("@TDSDeducted", o.TDSDeducted))
            Com1.Parameters.Add(New SqlParameter("@TotalAmount", o.TotalAmount))
            Com1.Parameters.Add(New SqlParameter("@TotalAmtAfterTDS", o.TotalAmtAfterTDS))
            Com1.Parameters.Add(New SqlParameter("@TotalAmtInWords", o.TotalAmtInWords))
            Com1.Parameters.Add(New SqlParameter("@TypeOfPayment", o.TypeOfPayment))
            Com1.Parameters.Add(New SqlParameter("@ModeOfPayment", o.ModeOfPayment))
            Com1.Parameters.Add(New SqlParameter("@GrideTotalAmt", o.GrideTotalAmt))
            Com1.Parameters.Add(New SqlParameter("@AdjAmount", o.AdjAmount))
            Com1.Parameters.Add(New SqlParameter("@BalAmt", o.BalAmt))
            If Trim(o.CallDate) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CallDate", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CallDate", o.CallDate))
            End If
            If Trim(o.CallTime) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CallTime", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CallTime", o.CallTime))
            End If
            Com1.Parameters.Add(New SqlParameter("@Comments", o.Comments))
            Com1.Parameters.Add(New SqlParameter("@OtherDetVerify", o.OtherDetVerify))
            Com1.Parameters.Add(New SqlParameter("@OtherDetComments", o.OtherDetComments))
            Com1.Parameters.Add(New SqlParameter("@SignVerify", o.RSignVerify))
            Com1.Parameters.Add(New SqlParameter("@SignComments", o.RSignComments))
            Com1.Parameters.Add(New SqlParameter("@RegType", o.RegType))
            Com1.Parameters.Add(New SqlParameter("@bhcode", o.bhcode))
            Com1.Parameters.Add(New SqlParameter("@PaymentOtherDetails", o.PaymentOtherDetails))

            If Trim(o.JointAdmConactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@JointAdmConactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@JointAdmConactcd", o.JointAdmConactcd))
            End If
            If Trim(o.Sourcecd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Sourcecd", o.Sourcecd))
            End If
            If Trim(o.refbyContactcd) = "" Then
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@refbyContactcd", o.refbyContactcd))
            End If
            'If Trim(o.RefFreeText) = "" Then
            '    Com1.Parameters.Add(New SqlParameter("@RefFreeText", System.DBNull.Value))
            'Else
            '    Com1.Parameters.Add(New SqlParameter("@RefFreeText", o.RefFreeText))
            'End If
            If Trim(o.ServiceTax) = "" Then
                Com1.Parameters.Add(New SqlParameter("@ServiceTax", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@ServiceTax", o.ServiceTax))
            End If
            If Trim(o.DateOfEntry) = "" Then
                Com1.Parameters.Add(New SqlParameter("@DateOfEntry", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@DateOfEntry", o.DateOfEntry))
            End If
            If Trim(o.CustPlanName) = "" Then
                Com1.Parameters.Add(New SqlParameter("@CustPlanName", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@CustPlanName", o.CustPlanName))
            End If

            If o.BatchID = "" Then
                Com1.Parameters.Add(New SqlParameter("@BatchID", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@BatchID", o.BatchID))
            End If
            If o.BatchRegDate = "" Then
                Com1.Parameters.Add(New SqlParameter("@BatchRegDate", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@BatchRegDate", o.BatchRegDate))
            End If
            If o.BatchRegTime = "" Then
                Com1.Parameters.Add(New SqlParameter("@BatchRegTime", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@BatchRegTime", o.BatchRegTime))
            End If
            If o.loccd = "" Then
                Com1.Parameters.Add(New SqlParameter("@loccd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@loccd", o.loccd))
            End If

            If o.SSPartName1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartName1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartName1", o.SSPartName1))
            End If
            If o.SSPartDesignation1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation1", o.SSPartDesignation1))
            End If
            If o.SSPartCompanyName1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName1", o.SSPartCompanyName1))
            End If
            If o.SSPartContactNo1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo1", o.SSPartContactNo1))
            End If
            If o.SSPartRelationship1 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship1", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship1", o.SSPartRelationship1))
            End If
            If o.SSPartName2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartName2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartName2", o.SSPartName2))
            End If
            If o.SSPartDesignation2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartDesignation2", o.SSPartDesignation2))
            End If
            If o.SSPartCompanyName2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartCompanyName2", o.SSPartCompanyName2))
            End If
            If o.SSPartContactNo2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartContactNo2", o.SSPartContactNo2))
            End If
            If o.SSPartRelationship2 = "" Then
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship2", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@SSPartRelationship2", o.SSPartRelationship2))
            End If
            If o.empcdConst = "" Then
                Com1.Parameters.Add(New SqlParameter("@empcdConst", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@empcdConst", o.empcdConst))
            End If
            If o.InvoiceRemark = "" Then
                Com1.Parameters.Add(New SqlParameter("@InvoiceRemark", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@InvoiceRemark", o.InvoiceRemark))
            End If
            If o.tallyrefno = "" Then
                Com1.Parameters.Add(New SqlParameter("@tallyrefno", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@tallyrefno", o.tallyrefno))
            End If
            If o.invdt = "" Then
                Com1.Parameters.Add(New SqlParameter("@invdt", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@invdt", o.invdt))
            End If

            Com1.Parameters.Add(New SqlParameter("@invoicingtype", o.invoicingtype))

            Com1.Parameters.Add(New SqlParameter("@crtuserid", o.crtuserid))
            Com1.Parameters.Add(New SqlParameter("@crtuserdt", o.crtuserdt))
            Com1.Parameters.Add(New SqlParameter("@moduserid", o.moduserid))
            Com1.Parameters.Add(New SqlParameter("@moduserdt", o.moduserdt))

            Com7.Parameters.Add(New SqlParameter("@Contactcd", o.Contactcd))
            Com7.Parameters.Add(New SqlParameter("@regid", o.RegID))
            If Trim(o.UploadAttName) <> "" Then
                Com7.Parameters.Add(New SqlParameter("@UploadAttName", o.UploadAttName))
            Else
                Com7.Parameters.Add(New SqlParameter("@UploadAttName", System.DBNull.Value))
            End If
            If Trim(o.UploadAttPath) <> "" Then
                Com7.Parameters.Add(New SqlParameter("@UploadAttPath", o.UploadAttPath))
            Else
                Com7.Parameters.Add(New SqlParameter("@UploadAttPath", System.DBNull.Value))
            End If

            If UCase(mode.Trim) = "ADD" Then
                Com1.Parameters.Add(New SqlParameter("@Flag", "A"))
            Else
                Com1.Parameters.Add(New SqlParameter("@Flag", "E"))
            End If


            Com8.Parameters.Add(New SqlParameter("@Contactcd", o.Contactcd))
            Com8.Parameters.Add(New SqlParameter("@regid", o.RegID))
            If Trim(o.addAttachmentName) <> "" Then
                Com8.Parameters.Add(New SqlParameter("@addAttachmentName", o.addAttachmentName))
            Else
                Com8.Parameters.Add(New SqlParameter("@addAttachmentName", System.DBNull.Value))
            End If
            If Trim(o.addAttachmentPath) <> "" Then
                Com8.Parameters.Add(New SqlParameter("@addAttachmentPath", o.addAttachmentPath))
            Else
                Com8.Parameters.Add(New SqlParameter("@addAttachmentPath", System.DBNull.Value))
            End If

            Ssql1 = "Sp_crmContacts_Client_AE_Register_SFB"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            Ssql2 = "Update crmcontacts set OpenLock = 0 where contactcd ='" & Trim(o.Contactcd) & "' "
            Com2.CommandText = Ssql2
            Com2.Transaction = Trans

            Ssql7 = "Sp_crmContacts_Client_UploadAtt_Register_SFB"
            Com7.CommandText = Ssql7
            Com7.Transaction = Trans

            Ssql8 = "Sp_crmContacts_Client_UploadAddAtt_Register_SFB"
            Com8.CommandText = Ssql8
            Com8.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                i = Com2.ExecuteNonQuery()
                i = Com7.ExecuteNonQuery()
                i = Com8.ExecuteNonQuery()
                If UCase(mode.Trim) = "ADD" Then
                Else
                    comdetold.ExecuteNonQuery()
                End If
                i = dadet.Update(ds, "RegisterDet")
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Com2 = Nothing
                Com7 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function
        '' End

        Public Shared Function Upload_Photo(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@Photo", o.Photo))
            db.Parameters.Add(New SqlParameter("@Photopath", o.Photopath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadPhoto")
            Return retval
        End Function

        Public Shared Function Upload_Application(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@AppformName", o.AppformName))
            db.Parameters.Add(New SqlParameter("@AppformPath", o.AppformPath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadAppForm")
            Return retval
        End Function

        Public Shared Function Upload_PAN(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@panname", o.panname))
            db.Parameters.Add(New SqlParameter("@panpath", o.panpath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadPan")
            Return retval
        End Function

        Public Shared Function Upload_Aadhar(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@aadharname", o.aadharname))
            db.Parameters.Add(New SqlParameter("@aadharpath", o.aadharpath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadAadhar")
            Return retval
        End Function

        Public Shared Function Upload_Passport(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@passportname", o.passportname))
            db.Parameters.Add(New SqlParameter("@passportpath", o.passportpath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadPassport")
            Return retval
        End Function

        Public Shared Function Upload_DrivLic(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@drvlicname", o.drvlicname))
            db.Parameters.Add(New SqlParameter("@drvlicpath", o.drvlicpath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadDrvlic")
            Return retval
        End Function

        Public Shared Function Upload_Other(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@OthersName", o.OthersName))
            db.Parameters.Add(New SqlParameter("@OthersPath", o.OthersPath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadOther")
            Return retval
        End Function

        Public Shared Function Upload_GST(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            If o.Contactcd = "" Then
                db.Parameters.Add(New SqlParameter("@contactcd", System.DBNull.Value))
            Else
                db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            End If
            db.Parameters.Add(New SqlParameter("@gstname", o.gstname))
            db.Parameters.Add(New SqlParameter("@gstpath", o.gstpath))

            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_GP_Client_UploadGST")
            Return retval
        End Function

        Public Shared Function Delete(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim db As DBAccess = New DBAccess
            db.Parameters.Add(New SqlParameter("@contactcd", o.Contactcd))
            Dim retval As Integer = db.ExecuteNonQuery("Sp_crmContacts_Delete")
            Return retval
        End Function

        Public Shared Function GetDocCode() As String
            Dim sSQL As String, objDas As New DBAccess, dt As DataTable
            sSQL = "SELECT MAX(cast(Contactcd as Integer)) AS Contactcd FROM crmcontacts"
            dt = objDas.GetDataTable(sSQL)
            If dt.Rows.Count > 0 Then
                If Not IsDBNull(dt.Rows(0).Item("Contactcd")) Then
                    If dt.Rows(0).Item("Contactcd").ToString <> "" Then
                        GetDocCode = dt.Rows(0)("Contactcd").ToString + 1
                    Else
                        GetDocCode = 1
                    End If
                Else
                    GetDocCode = 1
                End If
            End If
            Return GetDocCode
        End Function

        Public Shared Function GetAccounts() As DataTable
            Dim db As DBAccess = New DBAccess
            Dim dt As DataTable = db.ExecuteDataTable("Sp_ContactDatabase_SelectAll")
            Return dt
        End Function

        Public Shared Function GetConnection() As SqlConnection
            Return New SqlConnection(ConfigurationManager.ConnectionStrings("ConStrFood").ConnectionString)
        End Function

        Public Shared Function CheckDuplicate(ByVal strcode As String) As String
            Try
                Dim s As Object
                CheckDuplicate = ""
                s = DBAccess.Find_Value("crmcontacts", "contactname", "contactcd", Trim(strcode))
                If s IsNot Nothing Then
                    CheckDuplicate = s.ToString
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function CheckDuplicate_MobileNo(ByVal strcode As String) As String
            Try
                Dim s As Object
                CheckDuplicate_MobileNo = ""
                s = DBAccess.Find_Value("crmcontacts", "mobile", "contactcd", Trim(strcode))
                If s IsNot Nothing Then
                    CheckDuplicate_MobileNo = s.ToString
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function CheckDuplicate_Email(ByVal strcode As String) As String
            Try
                Dim sSQL As String, dt As DataTable, objDas As New DBAccess
                CheckDuplicate_Email = ""

                sSQL = "select contactcd from crmcontacts where isnull(email,'')<>'' and email='" & Trim(strcode) & "'"
                dt = objDas.GetDataTable(sSQL)
                If dt.Rows.Count > 0 Then
                    CheckDuplicate_Email = Trim(dt.Rows(0)("contactcd").ToString)
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Check_Duplicate_Name_email_Mobile(ByVal strname As String, ByVal strEmail As String, ByVal strmobile As String) As String
            Try
                Dim sSQL As String, dt As DataTable, objDas As New DBAccess
                Check_Duplicate_Name_email_Mobile = ""

                sSQL = "select contactcd from crmcontacts where isnull(email,'')<>'' and email='" & Trim(strEmail) & "' and Contactname='" & Trim(strname) & "' and mobile='" & Trim(strmobile) & "'"
                dt = objDas.GetDataTable(sSQL)
                If dt.Rows.Count > 0 Then
                    Check_Duplicate_Name_email_Mobile = Trim(dt.Rows(0)("contactcd").ToString)
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Check_Duplicate_FName_LName_Mobile(ByVal strname As String, ByVal strLName As String, ByVal strmobile As String) As String
            Try
                Dim sSQL As String, dt As DataTable, objDas As New DBAccess
                Check_Duplicate_FName_LName_Mobile = ""

                sSQL = "select contactcd from crmcontacts where isnull(Contactname,'')<>'' and Contactname='" & Trim(strname) & "' and LastName='" & Trim(strLName) & "' and mobile='" & Trim(strmobile) & "'"
                dt = objDas.GetDataTable(sSQL)
                If dt.Rows.Count > 0 Then
                    Check_Duplicate_FName_LName_Mobile = Trim(dt.Rows(0)("contactcd").ToString)
                End If
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function CheckDuplicate_Client(ByVal contactcd As String, ByVal LeadName As String, ByVal CompName As String, ByVal MobileNo As String) As String
            Dim s As Object
            CheckDuplicate_Client = ""
            s = Check_duplicate_CLient(Trim(contactcd), Trim(LeadName), Trim(CompName), Trim(MobileNo))
            If s IsNot Nothing Then
                CheckDuplicate_Client = s.ToString
            End If
        End Function

        Public Shared Function Check_duplicate_CLient(ByVal contactcd As String, ByVal LeadName As String, ByVal CompName As String, ByVal MobileNo As String) As String
            Dim con As New SqlConnection
            Dim com As New SqlCommand
            Dim pr As SqlParameter
            Dim obj As Object

            con = GetConnection()
            com = New SqlCommand
            com.Connection = con
            com.CommandType = CommandType.StoredProcedure
            com.CommandText = "CheckDuplicate_GP_SP"
            com.Parameters.AddWithValue("@contactcd", Trim(contactcd))
            com.Parameters.AddWithValue("@LeadName", Trim(LeadName))
            com.Parameters.AddWithValue("@CompName", Trim(CompName))
            com.Parameters.AddWithValue("@MobileNo", Trim(MobileNo))
            pr = com.Parameters.Add("@retval", SqlDbType.VarChar, 255)
            pr.Direction = ParameterDirection.Output
            Try
                con.Open()
                com.ExecuteNonQuery()
            Catch ex As Exception
                Throw ex
            Finally
                con.Close()
                con = Nothing
                com = Nothing
            End Try
            obj = pr.Value
            If IsDBNull(obj) = True Or IsNothing(obj.ToString) Then
                obj = Nothing
            End If
            Return obj
        End Function

        Public Shared Function CheckDuplicate_GP(ByVal contactcd As String, ByVal LeadName As String, ByVal MobileNo As String) As String
            Dim s As Object
            CheckDuplicate_GP = ""
            s = Check_duplicate_GP(Trim(contactcd), Trim(LeadName), Trim(MobileNo))
            If s IsNot Nothing Then
                CheckDuplicate_GP = s.ToString
            End If
        End Function

        Public Shared Function Check_duplicate_GP(ByVal contactcd As String, ByVal LeadName As String, ByVal MobileNo As String) As String
            Dim con As New SqlConnection
            Dim com As New SqlCommand
            Dim pr As SqlParameter
            Dim obj As Object

            con = GetConnection()
            com = New SqlCommand
            com.Connection = con
            com.CommandType = CommandType.StoredProcedure
            com.CommandText = "CheckDuplicate_Client_SP"
            com.Parameters.AddWithValue("@contactcd", Trim(contactcd))
            com.Parameters.AddWithValue("@LeadName", Trim(LeadName))
            'com.Parameters.AddWithValue("@CompName", Trim(CompName))
            com.Parameters.AddWithValue("@MobileNo", Trim(MobileNo))
            pr = com.Parameters.Add("@retval", SqlDbType.VarChar, 255)
            pr.Direction = ParameterDirection.Output
            Try
                con.Open()
                com.ExecuteNonQuery()
            Catch ex As Exception
                Throw ex
            Finally
                con.Close()
                con = Nothing
                com = Nothing
            End Try
            obj = pr.Value
            If IsDBNull(obj) = True Or IsNothing(obj.ToString) Then
                obj = Nothing
            End If
            Return obj
        End Function

        Public Shared Function GetDataAllFor_Client_Pending_IMP(ByVal loccd As String, ByVal Flag As String) As DataTable
            Try
                Dim db As DBAccess = New DBAccess
                db.Parameters.Add(New SqlParameter("@loccd", loccd))
                db.Parameters.Add(New SqlParameter("@Flag", Flag))

                Dim dt As DataTable = db.ExecuteDataTable("Sp_crmContacts_GetData_Pending_IMP")
                Return dt
            Catch ex As Exception
                Throw ex
            End Try
        End Function

        Public Shared Function Check_Account_Details(ByVal contactcd As String, ByVal productcd As String) As String
            Dim con As SqlConnection
            Dim com As SqlCommand
            Dim pr As SqlParameter
            Dim obj As Object

            con = GetConnection()
            com = New SqlCommand
            com.Connection = con
            com.CommandType = CommandType.StoredProcedure
            com.CommandText = "Check_AccountForReg_SP"
            com.Parameters.AddWithValue("@contactcd", Trim(contactcd))
            com.Parameters.AddWithValue("@productcd", Trim(productcd))
            pr = com.Parameters.Add("@RETVAL", SqlDbType.Char, 5)
            pr.Direction = ParameterDirection.Output
            Try
                con.Open()
                com.ExecuteNonQuery()
            Catch ex As Exception
                MsgBox(ex.Message)
            Finally
                con.Close()
                con = Nothing
                com = Nothing
            End Try

            obj = pr.Value
            If IsDBNull(obj) = True Or obj.ToString = "" Then
                obj = Nothing
            End If

            Return obj

        End Function

        Public Shared Function Find_Value(ByVal Table As String, ByVal Code As String, ByVal Name As String, ByVal value As Object) As Object
            Dim con As New SqlConnection
            Dim com As New SqlCommand
            Dim pr As SqlParameter
            Dim obj As Object

            con = GetConnection()
            com = New SqlCommand
            com.Connection = con
            com.CommandType = CommandType.StoredProcedure
            com.CommandText = "crmChkDuplicate_sp"
            com.Parameters.AddWithValue("tab", Trim(Table))
            com.Parameters.AddWithValue("code", Trim(Code))
            com.Parameters.AddWithValue("desc", Trim(Name))
            com.Parameters.AddWithValue("para", Trim(value))
            pr = com.Parameters.Add("RetVal", SqlDbType.VarChar, 500)
            pr.Direction = ParameterDirection.Output

            Try
                con.Open()
                com.ExecuteNonQuery()
            Catch ex As Exception
                MsgBox(ex.Message)
            Finally
                con.Close()
                con = Nothing
                com = Nothing
            End Try

            obj = pr.Value
            If IsDBNull(obj) = True Or IsNothing(obj.ToString) Then
                obj = Nothing
            End If

            Return obj
        End Function

        Public Shared Function CompanyCode() As String
            CompanyCode = "Z"
        End Function

        Public Shared Function GetCommand() As SqlCommand
            Return New SqlCommand()
        End Function

        Public Shared Function DocumentCode() As String
            Dim con As SqlConnection
            Dim com As SqlCommand
            Dim res As Object

            con = GetConnection()
            com = GetCommand()

            com.Connection = con
            com.CommandType = CommandType.Text
            com.CommandText = "select doccode from documents where docname='tr'"
            DocumentCode = ""

            Try
                con.Open()
                res = com.ExecuteScalar()
                If res IsNot Nothing Then
                    DocumentCode = res.ToString.Trim
                End If
            Catch ex As Exception
                MsgBox(ex.Message)
            Finally
                con.Close()
                con = Nothing
            End Try
        End Function

        Public Shared Function DocumentType() As String
            Dim con As SqlConnection
            Dim com As SqlCommand
            Dim res As Object

            con = GetConnection()
            com = GetCommand()

            com.Connection = con
            com.CommandType = CommandType.Text
            com.CommandText = "select typecode from doctype where typename='ot' and doccode='ot'"
            DocumentType = ""
            Try
                con.Open()
                res = com.ExecuteScalar()
                If res IsNot Nothing Then
                    DocumentType = res.ToString.Trim
                End If
            Catch ex As Exception
                MsgBox(ex.Message)
            Finally
                con.Close()
                con = Nothing
            End Try
        End Function

        Public Shared Function Fetch_Paramno() As Integer
            Dim con As SqlConnection
            Dim com As SqlCommand
            Dim ccode, DOCCODE, DOCTYPE As String
            Dim p As Int16

            ccode = CompanyCode()
            DOCCODE = DocumentCode()
            DOCTYPE = DocumentType()
            con = GetConnection()
            com = GetCommand()

            com.Connection = con
            com.CommandType = CommandType.Text
            com.CommandText = "select paramno from parameter where ccode='agpl'and paramtype='" & Trim(DOCCODE) & "' and doctype='" & Trim(DOCTYPE) & "'"

            Try
                con.Open()
                p = com.ExecuteScalar
                If IsDBNull(p) Then
                    p = 0
                End If
                p = p + 1
            Catch ex As Exception
                MsgBox(ex.Message)
            Finally
                con.Close()
                con = Nothing
            End Try

            Return p
        End Function

        Public Shared Function Generate_Docno(ByVal paramno As Integer) As String
            Dim startyr, endyr, doctype, doccode As String
            Dim ccode, docsrno As String

            ccode = CompanyCode()
            doccode = DocumentCode()
            doctype = DocumentType()
            docsrno = DocumentSrno(paramno, 5)

            'startyr = Right((ClsGeneral.FinStart).ToString.Trim, 2)
            'endyr = Right((ClsGeneral.FinEnd).ToString.Trim, 2)
            startyr = Right("1/4/2012", 2)
            endyr = Right("1/4/2013", 2)

            Generate_Docno = Trim(ccode) + "-" + Trim(docsrno)
        End Function

        Public Shared Function DocumentSrno(ByVal p As Integer, ByVal strlen As Integer) As String
            If strlen > Len(CStr(p)) Then
                DocumentSrno = StrDup(strlen - Len(CStr(p)), "0") + CStr(p)
            Else
                DocumentSrno = CStr(p)
            End If
        End Function

        Public Shared Function Check_Integrity(ByVal strcode As String) As String
            Dim con As SqlConnection
            Dim com As SqlCommand
            Dim pr As SqlParameter
            Dim obj As Object

            con = GetConnection()
            com = New SqlCommand
            com.Connection = con
            com.CommandType = CommandType.StoredProcedure
            com.CommandText = "CheckIntegrity_Contact_Sp"
            com.Parameters.AddWithValue("@code", Trim(strcode))
            pr = com.Parameters.Add("@reftblname", SqlDbType.Char, 60)
            pr.Direction = ParameterDirection.Output

            Try
                con.Open()
                com.ExecuteNonQuery()
            Catch ex As Exception
                MsgBox(ex.Message)
            Finally
                con.Close()
                con = Nothing
                com = Nothing
            End Try

            obj = pr.Value
            If IsDBNull(obj) = True Or obj.ToString = "" Then
                obj = Nothing
            End If

            Return obj

        End Function

        Public Shared Function GetDataForGride() As DataSet
            Dim dadet, dadet1 As New SqlDataAdapter
            Dim con As SqlConnection
            Dim comdet, comdet1 As SqlCommand
            Dim ds As DataSet

            con = GetConnection()
            comdet = GetCommand()
            comdet1 = GetCommand()
            ds = New DataSet

            comdet.Connection = con
            comdet.CommandType = CommandType.Text
            comdet.CommandText = "select * from crmcontacts where statuscd=''"
            dadet.SelectCommand = comdet

            Try
                dadet.Fill(ds, "crmcontacts")
            Catch ex As Exception
                Throw ex
            Finally
                con.Close()
                con = Nothing
                comdet = Nothing
                dadet = Nothing
            End Try
            Return ds
        End Function

        Public Shared Function TransferLead(ByVal o As ClsCRMContactForGPAndClient_All_New) As Integer
            Dim Con As SqlConnection
            Dim Trans As SqlTransaction
            Dim Com1 As SqlCommand
            Dim Ssql1 As String
            Dim i As Integer

            Con = GetConnection()
            Con.Open()
            Trans = Con.BeginTransaction

            Com1 = New SqlCommand
            Com1.Connection = Con
            Com1.CommandType = CommandType.StoredProcedure

            If o.Contactcd = "" Then
                Com1.Parameters.Add(New SqlParameter("@Contactcd", System.DBNull.Value))
            Else
                Com1.Parameters.Add(New SqlParameter("@Contactcd", o.Contactcd))
            End If
            Com1.Parameters.Add(New SqlParameter("@statuscd", o.statuscd))
            Com1.Parameters.Add(New SqlParameter("@userid", o.crtuserid))

            Ssql1 = "Sp_TransderLead_AE"
            Com1.CommandText = Ssql1
            Com1.Transaction = Trans

            Try
                i = Com1.ExecuteNonQuery()
                Trans.Commit()
            Catch ex As Exception
                If (Not (Trans) Is Nothing) Then
                    Trans.Rollback()
                End If
                Throw ex
            Finally
                Com1 = Nothing
                Con.Close()
                Con = Nothing
                Trans = Nothing
            End Try
            Return i
        End Function

        Public Shared Function Find_Citycd(ByVal strcode As String) As String
            Dim s As Object
            Find_Citycd = ""
            s = DBAccess.Find_Value("crmcity", "cityname", "citycd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Citycd = s.ToString
            End If
        End Function

        Public Shared Function Find_Statecd(ByVal strcode As String) As String
            Dim s As Object
            Find_Statecd = ""
            s = DBAccess.Find_Value("crmstate", "statename", "statecd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Statecd = s.ToString
            End If
        End Function

        Public Shared Function Find_Countrycd(ByVal strcode As String) As String
            Dim s As Object
            Find_Countrycd = ""
            s = DBAccess.Find_Value("crmcountry", "countryname", "countrycd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Countrycd = s.ToString
            End If
        End Function

        Public Shared Function Find_Areacd(ByVal strcode As String) As String
            Dim s As Object
            Find_Areacd = ""
            s = DBAccess.Find_Value("crmarea", "areaname", "areacd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Areacd = s.ToString
            End If
        End Function

        Public Shared Function Find_Sourcecd(ByVal strcode As String) As String
            Dim s As Object
            Find_Sourcecd = ""
            s = DBAccess.Find_Value("CRMSourceMaster", "SourceName", "Sourcecd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Sourcecd = s.ToString
            End If
        End Function

        Public Shared Function Find_Segmentcd(ByVal strcode As String) As String
            Dim s As Object
            Find_Segmentcd = ""
            s = DBAccess.Find_Value("CRMSegmentMaster", "Segmentname", "Segmentcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Segmentcd = s.ToString
            End If
        End Function

        Public Shared Function Find_Agecd(ByVal strcode As String) As String
            Dim s As Object
            Find_Agecd = ""
            s = DBAccess.Find_Value("CRMAgeMaster", "AgeName", "Agecd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Agecd = s.ToString
            End If
        End Function

        Public Shared Function Find_AgeQScore(ByVal strcode As String) As String
            Dim s As Object
            Find_AgeQScore = ""
            s = DBAccess.Find_Value("CRMAgeMaster", "Agecd", "AgeName", Trim(strcode))
            If s IsNot Nothing Then
                Find_AgeQScore = s.ToString
            End If
        End Function

        Public Shared Function Find_LivingInCitycd(ByVal strcode As String) As String
            Dim s As Object
            Find_LivingInCitycd = ""
            s = DBAccess.Find_Value("CRMLivingInCityMaster", "LivingInCityName", "LivingInCitycd", Trim(strcode))
            If s IsNot Nothing Then
                Find_LivingInCitycd = s.ToString
            End If
        End Function

        Public Shared Function Find_CityQScore(ByVal strcode As String) As String
            Dim s As Object
            Find_CityQScore = ""
            s = DBAccess.Find_Value("CRMLivingInCityMaster", "LivingInCitycd", "LivingInCityName", Trim(strcode))
            If s IsNot Nothing Then
                Find_CityQScore = s.ToString
            End If
        End Function

        Public Shared Function Find_incomerangecd(ByVal strcode As String) As String
            Dim s As Object
            Find_incomerangecd = ""
            s = DBAccess.Find_Value("crmincomerange", "incomerangename", "incomerangecd", Trim(strcode))
            If s IsNot Nothing Then
                Find_incomerangecd = s.ToString
            End If
        End Function

        Public Shared Function Find_incomerangeQScore(ByVal strcode As String) As String
            Dim s As Object
            Find_incomerangeQScore = ""
            s = DBAccess.Find_Value("crmincomerange", "incomerangecd", "incomerangename", Trim(strcode))
            If s IsNot Nothing Then
                Find_incomerangeQScore = s.ToString
            End If
        End Function

        Public Shared Function Find_Educationcd(ByVal strcode As String) As String
            Dim s As Object
            Find_Educationcd = ""
            s = DBAccess.Find_Value("CRMEducationMaster", "EducationName", "Educationcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Educationcd = s.ToString
            End If
        End Function

        Public Shared Function Find_EducationQScore(ByVal strcode As String) As String
            Dim s As Object
            Find_EducationQScore = ""
            s = DBAccess.Find_Value("CRMEducationMaster", "Educationcd", "EducationName", Trim(strcode))
            If s IsNot Nothing Then
                Find_EducationQScore = s.ToString
            End If
        End Function

        Public Shared Function Find_Occupationcd(ByVal strcode As String) As String
            Dim s As Object
            Find_Occupationcd = ""
            s = DBAccess.Find_Value("CRMOccupationMaster", "OccupationName", "Occupationcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_Occupationcd = s.ToString
            End If
        End Function

        Public Shared Function Find_OccupationQScore(ByVal strcode As String) As String
            Dim s As Object
            Find_OccupationQScore = ""
            s = DBAccess.Find_Value("CRMOccupationMaster", "Occupationcd", "OccupationName", Trim(strcode))
            If s IsNot Nothing Then
                Find_OccupationQScore = s.ToString
            End If
        End Function

        Public Shared Function Find_leadindcd(ByVal strcode As String) As String
            Dim s As Object
            Find_leadindcd = ""
            s = DBAccess.Find_Value("crmleadindustry", "leadindname", "leadindcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_leadindcd = s.ToString
            End If
        End Function

        Public Shared Function Find_RefBy(ByVal strcode As String) As String
            Dim s As Object
            Find_RefBy = ""
            s = DBAccess.Find_Value("crmleadtype", "ltypename", "ltypecd", Trim(strcode))
            If s IsNot Nothing Then
                Find_RefBy = s.ToString
            End If
        End Function

        Public Shared Function Find_NoofEmployeescd(ByVal strcode As String) As String
            Dim s As Object
            Find_NoofEmployeescd = ""
            s = DBAccess.Find_Value("CRMNoofEmployeesMaster", "NoofEmployeesName", "NoofEmployeescd", Trim(strcode))
            If s IsNot Nothing Then
                Find_NoofEmployeescd = s.ToString
            End If
        End Function

        Public Shared Function Find_AnnualTurnoverCd(ByVal strcode As String) As String
            Dim s As Object
            Find_AnnualTurnoverCd = ""
            s = DBAccess.Find_Value("CRMAnnualTurnoverMaster", "AnnualTurnoverName", "AnnualTurnover", Trim(strcode))
            If s IsNot Nothing Then
                Find_AnnualTurnoverCd = s.ToString
            End If
        End Function

        Public Shared Function Find_YearofEst(ByVal strcode As String) As String
            Dim s As Object
            Find_YearofEst = ""
            s = DBAccess.Find_Value("CRMYearofEstablishmentMaster", "YearofEstablishmentName", "YearofEst", Trim(strcode))
            If s IsNot Nothing Then
                Find_YearofEst = s.ToString
            End If
        End Function

        Public Shared Function Find_qulificationcd(ByVal strcode As String) As String
            Dim s As Object
            Find_qulificationcd = ""
            s = DBAccess.Find_Value("qulificationcd", "qulificationname", "qulificationcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_qulificationcd = s.ToString
            End If
        End Function

        Public Shared Function Find_AreaLocationcd(ByVal strcode As String) As String
            Dim s As Object
            Find_AreaLocationcd = ""
            s = DBAccess.Find_Value("AreaLocation", "AreaLocationname", "AreaLocationcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_AreaLocationcd = s.ToString
            End If
        End Function

        Public Shared Function Find_contactcdCode(ByVal strcode As String) As String
            Dim s As Object
            Find_contactcdCode = ""
            s = DBAccess.Find_Value("crmcontacts", "contactcd", "contactname", Trim(strcode))
            If s IsNot Nothing Then
                Find_contactcdCode = s.ToString
            End If
        End Function

        Public Shared Function Find_contactcdName(ByVal strcode As String) As String
            Dim s As Object
            Find_contactcdName = ""
            s = DBAccess.Find_Value("crmcontacts", "contactname", "contactcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_contactcdName = s.ToString
            End If
        End Function

        Public Shared Function Find_empcdCode(ByVal strcode As String) As String
            Dim s As Object
            Find_empcdCode = ""
            s = DBAccess.Find_Value("hremployee", "empcd", "empname", Trim(strcode))
            If s IsNot Nothing Then
                Find_empcdCode = s.ToString
            End If
        End Function

        Public Shared Function Find_empcdName(ByVal strcode As String) As String
            Dim s As Object
            Find_empcdName = ""
            s = DBAccess.Find_Value("hremployee", "empname", "empcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_empcdName = s.ToString
            End If
        End Function

        Public Shared Function Find_empMobileCode(ByVal strcode As String) As String
            Dim s As Object
            Find_empMobileCode = ""
            s = DBAccess.Find_Value("hremployee", "empcd", "mobile", Trim(strcode))
            If s IsNot Nothing Then
                Find_empMobileCode = s.ToString
            End If
        End Function

        Public Shared Function Find_ProductShortName(ByVal strcode As String) As String
            Dim s As Object
            Find_ProductShortName = ""
            s = DBAccess.Find_Value("product", "productcd", "shortname", Trim(strcode))
            If s IsNot Nothing Then
                Find_ProductShortName = s.ToString
            End If
        End Function

        Public Shared Function Find_DesigcdCode(ByVal strcode As String) As String
            Dim s As Object
            Find_DesigcdCode = ""
            s = DBAccess.Find_Value("Designation", "DesignationCode", "DesignationName", Trim(strcode))
            If s IsNot Nothing Then
                Find_DesigcdCode = s.ToString
            End If
        End Function

        Public Shared Function Find_DesigcdName(ByVal strcode As String) As String
            Dim s As Object
            Find_DesigcdName = ""
            s = DBAccess.Find_Value("Designation", "DesignationName", "DesignationCode", Trim(strcode))
            If s IsNot Nothing Then
                Find_DesigcdName = s.ToString
            End If
        End Function

        Public Shared Function Find_ProductcdCode(ByVal strcode As String) As String
            Dim s As Object
            Find_ProductcdCode = ""
            s = DBAccess.Find_Value("product", "productcd", "productname", Trim(strcode))
            If s IsNot Nothing Then
                Find_ProductcdCode = s.ToString
            End If
        End Function

        Public Shared Function Find_ProductcdName(ByVal strcode As String) As String
            Dim s As Object
            Find_ProductcdName = ""
            s = DBAccess.Find_Value("product", "productname", "productcd", Trim(strcode))
            If s IsNot Nothing Then
                Find_ProductcdName = s.ToString
            End If
        End Function

    End Class
End Namespace

